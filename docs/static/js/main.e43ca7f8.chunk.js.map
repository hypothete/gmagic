{"version":3,"sources":["utils/colors.js","actions/actionTypes.js","actions/commands.js","components/Canvas.js","components/CommandListItem.js","actions/activeCommand.js","components/CommandList.js","components/ColorPalette.js","components/PatternToggle.js","components/ToolsPalette.js","actions/drawingMode.js","actions/modal.js","components/ExportModal.js","components/App.js","serviceWorker.js","store/initialState.js","reducers/index.js","reducers/commands.js","reducers/activeCommand.js","reducers/drawingMode.js","reducers/modal.js","store/index.js","index.js"],"names":["hex","ADD_COMMAND","REMOVE_COMMAND","MOVE_COMMAND_UP","MOVE_COMMAND_DOWN","MOVE_POINT","ADD_POINT","REMOVE_POINT","SET_COLOR","NAME_COMMAND","SET_PATTERN","ADD_BACKGROUND","SET_COMMANDS","SET_ACTIVE_COMMAND","SET_DRAWING_MODE","OPEN_MODAL","CLOSE_MODAL","commandCount","CanvasFrame","styled","div","_templateObject","ZoomCtrls","_templateObject2","props","dragging","PixelCanvas","canvas","_templateObject3","scale","clamp","val","min","max","Math","Canvas","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","renderCanvas","bind","assertThisInitialized","handleMouseDown","handleMouseMove","handleMouseUp","handleClick","handleContextMenu","zoomIn","zoomOut","state","dragIndex","refs","width","height","ctx","getContext","nextProps","setState","x","y","colors","pattern","pf","fillStyle","fillRect","x0","y0","x1","y1","e2","dx","abs","dy","sx","sy","err","loopCt","console","error","concat","fillPattern","pts","polyCorners","length","polyX","polyY","h","push","nodeX","nodes","j","i","round","k","swap","l","bresenham","_this2","clearRect","activeCmd","commands","activeCommand","toConsumableArray","forEach","cmd","type","polygon","points","id","globalCompositeOperation","strokeStyle","colorId","strokeRect","evt","rect","getBoundingClientRect","floor","clientX","left","clientY","top","a","b","pow","_this3","xy","convert","find","someCmd","nearest","pt","dist","stopPropagation","preventDefault","drawingMode","_this$convert","addPoint","getNearestPoint","_this$convert2","movePoint","react_default","createElement","key","onMouseUp","onMouseMove","ref","onMouseDown","onClick","onContextMenu","role","aria-label","Component","connect","types","payload","index","removePoint","typeToEmoji","LINE","POLYGON","ListEntry","CommandListItem_templateObject","active","EntryCtrls","CommandListItem_templateObject2","EntryText","CommandListItem_templateObject3","EntrySwatch","_templateObject4","color","EntrySwatches","_templateObject5","CommandListItem","selectItem","moveUp","moveDown","remove","handleNameChange","item","setActiveCommand","moveCommandUp","moveCommandDown","removeCommand","nameCommand","target","value","_this$props","name","onChange","mapDispatchToProps","command","StyledList","CommandList_templateObject","CommandList","map","components_CommandListItem","PaletteWrap","ColorPalette_templateObject","Swatch","ColorPalette_templateObject2","ColorPalette","activeIndex","setColor","col","colorIndex","Wrap","PatternToggle_templateObject","Check","input","PatternToggle_templateObject2","PatternToggle","values","toggleValue","setPattern","valIndex","checked","ToolsWrap","ToolsPalette_templateObject","ToolsColumn","ToolsPalette_templateObject2","ToolButton","button","ToolsPalette_templateObject3","ToolRow","ToolsPalette_templateObject4","ToolsPalette","addCommand","setDrawingMode","addBackground","openModal","react","components_ColorPalette","components_PatternToggle","mode","Overlay","ExportModal_templateObject","ModalWindow","ExportModal_templateObject2","Header","ExportModal_templateObject3","Body","ExportModal_templateObject4","ExitButton","ExportModal_templateObject5","ExportModal","exitModal","importFile","reader","FileReader","onload","loadevt","data","JSON","parse","result","setCommands","closeModal","readAsText","files","count","v","w","cmds","str","hexCol","patternData","calculatePattern","join","toString","modalOpen","jsonBlob","Blob","stringify","picoBlob","compressToPico","jsonUrl","window","URL","createObjectURL","picoUrl","download","href","Row","App_templateObject","App_templateObject2","App","App_Wrap","components_Canvas","components_CommandList","components_ToolsPalette","components_ExportModal","Boolean","location","hostname","match","initialState","combineReducers","arguments","undefined","action","filter","comm","foundCmdIndex","findIndex","foundCmd","slice","objectSpread","_action$payload","idx","_action$payload2","_action$payload3","splice","_action$payload4","someCol","someIndex","_action$payload5","_action$payload6","createStore","rootReducer","__REDUX_DEVTOOLS_EXTENSION__","rootElement","document","getElementById","ReactDOM","render","es","store","components_App","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"6QAEaA,EAAM,CACjB,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,WClBWC,EAAc,cACdC,EAAiB,iBACjBC,EAAkB,kBAClBC,EAAoB,oBACpBC,EAAa,aACbC,EAAY,YACZC,EAAe,eACfC,EAAY,YACZC,EAAe,eACfC,EAAc,cACdC,EAAiB,iBACjBC,EAAe,eAEfC,EAAqB,qBAErBC,EAAmB,mBAEnBC,EAAa,aACbC,EAAc,cChBvBC,EAAe,m4BCMnB,IAAMC,EAAcC,IAAOC,IAAVC,KAYXC,EAAYH,IAAOC,IAAVG,IAEF,SAAAC,GAAK,OAAIA,EAAMC,SAAW,OAAS,UAM1CC,EAAcP,IAAOQ,OAAVC,IACN,SAAAJ,GAAK,OAAIA,EAAMK,OACd,SAAAL,GAAK,OAAIA,EAAMK,QAc3B,SAASC,EAAMC,EAAKC,EAAKC,GACvB,OAAOC,KAAKD,IAAIC,KAAKF,IAAIC,EAAKF,GAAMC,OAGhCG,cACJ,SAAAA,EAAYX,GAAO,IAAAY,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAJ,IACjBC,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAF,GAAAO,KAAAH,KAAMf,KACDmB,aAAeP,EAAKO,aAAaC,KAAlBP,OAAAQ,EAAA,EAAAR,QAAAQ,EAAA,EAAAR,CAAAD,KACpBA,EAAKU,gBAAkBV,EAAKU,gBAAgBF,KAArBP,OAAAQ,EAAA,EAAAR,QAAAQ,EAAA,EAAAR,CAAAD,KACvBA,EAAKW,gBAAkBX,EAAKW,gBAAgBH,KAArBP,OAAAQ,EAAA,EAAAR,QAAAQ,EAAA,EAAAR,CAAAD,KACvBA,EAAKY,cAAgBZ,EAAKY,cAAcJ,KAAnBP,OAAAQ,EAAA,EAAAR,QAAAQ,EAAA,EAAAR,CAAAD,KACrBA,EAAKa,YAAcb,EAAKa,YAAYL,KAAjBP,OAAAQ,EAAA,EAAAR,QAAAQ,EAAA,EAAAR,CAAAD,KACnBA,EAAKc,kBAAoBd,EAAKc,kBAAkBN,KAAvBP,OAAAQ,EAAA,EAAAR,QAAAQ,EAAA,EAAAR,CAAAD,KACzBA,EAAKe,OAASf,EAAKe,OAAOP,KAAZP,OAAAQ,EAAA,EAAAR,QAAAQ,EAAA,EAAAR,CAAAD,KACdA,EAAKgB,QAAUhB,EAAKgB,QAAQR,KAAbP,OAAAQ,EAAA,EAAAR,QAAAQ,EAAA,EAAAR,CAAAD,KAEfA,EAAKiB,MAAQ,CACXC,WAAY,EACZzB,MAAO,KAbQO,mFAkBjBG,KAAKgB,KAAK5B,OAAO6B,MAAQ,IACzBjB,KAAKgB,KAAK5B,OAAO8B,OAAS,IAC1BlB,KAAKmB,IAAMnB,KAAKgB,KAAK5B,OAAOgC,WAAW,MACvCpB,KAAKI,aAAaJ,KAAKf,yDAGCoC,GACxBrB,KAAKI,aAAaiB,oCAIlBrB,KAAKsB,SAAS,CACZhC,MAA0B,EAAnBU,KAAKc,MAAMxB,0CAKpBU,KAAKsB,SAAS,CACZhC,MAAOU,KAAKc,MAAMxB,MAAQ,wCAIlBiC,EAAGC,EAAGC,EAAQC,GACxB,IAGMC,EAAKD,EADK,GADLF,EAAI,GADJD,EAAI,GAIfvB,KAAKmB,IAAIS,UAAYnE,EAAIgE,EAAOE,EAAK,EAAI,IACzC3B,KAAKmB,IAAIU,SAASN,EAAGC,EAAE,EAAE,qCAIjBM,EAAIC,EAAIC,EAAIC,EAAIR,EAAQC,GAShC,IARA,IAMIQ,EANEC,EAAKxC,KAAKyC,IAAIJ,EAAKF,GACnBO,GAAM1C,KAAKyC,IAAIH,EAAKF,GACpBO,EAAMR,EAAKE,EAAM,GAAK,EACtBO,EAAMR,EAAKE,EAAM,GAAK,EACxBV,EAAIO,EAAIN,EAAIO,EACZS,EAAML,EAAKE,EAEXI,EAAS,IACV,CAED,KADAA,EACa,IAAK,CAChBC,QAAQC,MAAR,sBAAAC,OAAoCd,EAApC,MAAAc,OAA2Cb,EAA3C,QAAAa,OAAoDZ,EAApD,MAAAY,OAA2DX,IAC3D,MAGF,GADAjC,KAAK6C,YAAYtB,EAAEC,EAAGC,EAAQC,GACzBH,IAAIS,GAAQR,IAAIS,EAAK,OAC1BC,EAAK,EAAIM,IACCH,IACRG,GAAOH,EACPd,GAAKe,GAEHJ,GAAMC,IACRK,GAAOL,EACPX,GAAKe,oCAKHO,EAAKrB,EAAQC,GAMnB,IAJA,IAAMqB,EAAcD,EAAIE,OAAS,EAC3BC,EAAQ,GACRC,EAAQ,GAELC,EAAE,EAAGA,EAAEL,EAAIE,OAAQG,GAAG,EAC7BF,EAAMG,KAAKN,EAAIK,IACfD,EAAME,KAAKN,EAAIK,EAAE,IAGnB,IAAK,IAAI3B,EAAE,EAAGA,EAAExB,KAAKgB,KAAK5B,OAAO8B,OAAQM,IAAK,CAI5C,IAHA,IAAM6B,EAAQ,GACVC,EAAQ,EACRC,EAAIR,EAAc,EACbS,EAAE,EAAGA,EAAET,EAAaS,KAEvBN,EAAMM,GAAKhC,GAAO0B,EAAMK,IAAM/B,GAC9B0B,EAAMK,GAAK/B,GAAO0B,EAAMM,IAAMhC,KAEhC6B,EAAMC,KACJL,EAAMO,GACN7D,KAAK8D,OAAOjC,EAAE0B,EAAMM,KAAKN,EAAMK,GAAGL,EAAMM,GAAK,OAC5CP,EAAMM,GAAKN,EAAMO,MAGtBD,EAAIC,EAIN,IADA,IAAIE,EAAE,EACAA,EAAIJ,EAAM,GACd,GAAID,EAAMK,GAAKL,EAAMK,EAAE,GAAI,CACzB,IAAIC,EAAON,EAAMK,GACjBL,EAAMK,GAAKL,EAAMK,EAAE,GACnBL,EAAMK,EAAE,GAAKC,EACTD,GAAGA,SAGPA,IAIJ,IAAK,IAAIE,EAAE,EAAGA,EAAEN,KACVD,EAAMO,IAAM5D,KAAKgB,KAAK5B,OAAO6B,OADZ2C,GAAG,EAEpBP,EAAMO,EAAE,GAAK,IACXP,EAAMO,GAAK,IAAGP,EAAMO,GAAK,GACzBP,EAAMO,EAAE,GAAK5D,KAAKgB,KAAK5B,OAAO6B,QAAOoC,EAAMO,EAAE,GAAK5D,KAAKgB,KAAK5B,OAAO6B,MAAM,GAC7EjB,KAAK6D,UAAUR,EAAMO,GAAIpC,EAAG6B,EAAMO,EAAE,GAAIpC,EAAGC,EAAQC,0CAM9CzC,GAAO,IAAA6E,EAAA9D,KAClBA,KAAKmB,IAAI4C,UAAU,EAAG,EAAG/D,KAAKgB,KAAK5B,OAAO6B,MAAOjB,KAAKgB,KAAK5B,OAAO8B,QADhD,IAId8C,EAFGC,EAA2BhF,EAA3BgF,SAAUC,EAAiBjF,EAAjBiF,cA0BjB,GAzBUpE,OAAAqE,EAAA,EAAArE,CAAOmE,GAEZG,QAAQ,SAAAC,GACX,OAAOA,EAAIC,MACT,IAAK,UACHR,EAAKS,QAAQF,EAAIG,OAAQH,EAAI5C,OAAQ4C,EAAI3C,SACzC,MAEF,IAAK,OACH,IAAK,IAAI8B,EAAI,EAAGA,EAAIa,EAAIG,OAAOxB,OAAO,EAAGQ,GAAG,EAAG,CAC7C,IAAM1B,EAAKuC,EAAIG,OAAOhB,GAChBzB,EAAKsC,EAAIG,OAAOhB,EAAE,GAClBxB,EAAKqC,EAAIG,OAAOhB,EAAE,GAClBvB,EAAKoC,EAAIG,OAAOhB,EAAE,GACxBM,EAAKD,UAAU/B,EAAIC,EAAIC,EAAIC,EAAIoC,EAAI5C,OAAQ4C,EAAI3C,SAEjD,MAEF,QACE,OAED2C,EAAII,KAAOP,IACZF,EAAYK,KAGbL,EAAW,CAEZhE,KAAKmB,IAAIuD,yBAA2B,MACpC1E,KAAKmB,IAAIwD,YAAclH,EAAIuG,EAAUY,SACrC,IAAK,IAAIpB,EAAE,EAAGA,EAAGQ,EAAUQ,OAAOxB,OAAQQ,GAAG,EAAG,CAC9C,IAAMjC,EAAIyC,EAAUQ,OAAOhB,GAAK,GAC1BhC,EAAIwC,EAAUQ,OAAOhB,EAAE,GAAK,GAClCxD,KAAKmB,IAAI0D,WAAWtD,EAAE,EAAGC,EAAE,EAAG,EAAG,GAEnCxB,KAAKmB,IAAIuD,yBAA2B,+CAIhCI,GACN,IAAMC,EAAO/E,KAAKgB,KAAK5B,OAAO4F,wBAC9B,MAAO,CACLzD,EAAGhC,EAAMI,KAAKsF,MAAMjF,KAAKgB,KAAK5B,OAAO6B,OAAS6D,EAAII,QAAUH,EAAKI,MAAQJ,EAAK9D,OAAQ,EAAGjB,KAAKgB,KAAK5B,OAAO6B,OAC1GO,EAAGjC,EAAMI,KAAKsF,MAAMjF,KAAKgB,KAAK5B,OAAO8B,QAAU4D,EAAIM,QAAUL,EAAKM,KAAON,EAAK7D,QAAS,EAAGlB,KAAKgB,KAAK5B,OAAO8B,sCAIzGoE,EAAGC,GAEP,OAAO5F,KAAK6F,IAAID,EAAEhE,EAAE+D,EAAE/D,EAAG,GAAK5B,KAAK6F,IAAID,EAAE/D,EAAI8D,EAAE9D,EAAG,2CAGpCsD,GAKd,IALmB,IAAAW,EAAAzF,KACb0F,EAAK1F,KAAK2F,QAAQb,GAClBT,EAAMrE,KAAKf,MAAMgF,SAAS2B,KAAK,SAAAC,GAAO,OAAIA,EAAQpB,KAAOgB,EAAKxG,MAAMiF,gBAEtE4B,GAAW,EACPtC,EAAE,EAAGA,EAAIa,EAAIG,OAAOxB,OAAQQ,GAAG,EAAG,CACxC,IAAMuC,EAAK,CACTxE,EAAG8C,EAAIG,OAAOhB,GACdhC,EAAG6C,EAAIG,OAAOhB,EAAE,IAGlB,GADaxD,KAAKgG,KAAKD,EAAIL,GAChB,EAAG,CACZI,EAAUtC,EACV,OAGJ,OAAOsC,sCAGGhB,GAGV,GAFAA,EAAImB,kBACJnB,EAAIoB,iBACClG,KAAKf,MAAMiF,eACe,gBAA3BlE,KAAKf,MAAMkH,YAAf,CAJe,IAAAC,EAMEpG,KAAK2F,QAAQb,GAAtBvD,EANO6E,EAMP7E,EAAGC,EANI4E,EAMJ5E,EACXxB,KAAKf,MAAMoH,SAASrG,KAAKf,MAAMiF,cAAe3C,EAAGC,4CAGnCsD,GAGd,GAFAA,EAAImB,kBACJnB,EAAIoB,iBACClG,KAAKf,MAAMiF,eAA4C,gBAA3BlE,KAAKf,MAAMkH,YAA5C,CACA,IAAML,EAAU9F,KAAKsG,gBAAgBxB,GACjCgB,GAAW,GAEb9F,KAAKsB,SAAS,CACZP,UAAW+E,6CAKDhB,GAGd,GAFAA,EAAImB,kBACJnB,EAAIoB,mBACAlG,KAAKc,MAAMC,UAAY,GAA3B,CAHmB,IAAAwF,EAKJvG,KAAK2F,QAAQb,GAArBvD,EALYgF,EAKZhF,EAAGC,EALS+E,EAKT/E,EACVxB,KAAKf,MAAMuH,UAAUxG,KAAKf,MAAMiF,cAAelE,KAAKc,MAAMC,UAAWQ,EAAGC,0CAG5DsD,GACZA,EAAImB,kBACJnB,EAAIoB,iBACJlG,KAAKsB,SAAS,CACZP,WAAY,8CAIE+D,GAGhB,OAFAA,EAAImB,kBACJnB,EAAIoB,kBACG,mCAIP,MAAO,CACLO,EAAAnB,EAAAoB,cAAC/H,EAAD,CAAagI,IAAI,QAAQC,UAAW5G,KAAKS,cAAeoG,YAAa7G,KAAKQ,iBACxEiG,EAAAnB,EAAAoB,cAACvH,EAAD,CAAaG,MAAOU,KAAKc,MAAMxB,MAAOwH,IAAI,SACxCC,YAAa/G,KAAKO,gBAClByG,QAAShH,KAAKU,YACduG,cAAejH,KAAKW,qBAGxB8F,EAAAnB,EAAAoB,cAAC3H,EAAD,CAAW4H,IAAI,QAAQzH,SAAUc,KAAKc,MAAMC,WAAa,GACvD0F,EAAAnB,EAAAoB,cAAA,UAAQM,QAAShH,KAAKY,QAAQ6F,EAAAnB,EAAAoB,cAAA,QAAMQ,KAAK,MAAMC,aAAW,WAA5B,WAC9BV,EAAAnB,EAAAoB,cAAA,UAAQM,QAAShH,KAAKa,SAAS4F,EAAAnB,EAAAoB,cAAA,QAAMQ,KAAK,MAAMC,aAAW,YAA5B,oBAvQlBC,aAqRNC,cARS,SAAAvG,GACtB,MAAO,CACLmD,SAAUnD,EAAMmD,SAChBC,cAAepD,EAAMoD,cACrBiC,YAAarF,EAAMqF,cAIiB,CAACE,SD3RlC,SAAkB5B,EAAIlD,EAAGC,GAC9B,MAAO,CACL8C,KAAMgD,EACNC,QAAS,CAAE9C,KAAIlD,IAAGC,OCwR6BgF,UDlS5C,SAAmB/B,EAAI+C,EAAOjG,EAAGC,GACtC,MAAO,CACL8C,KAAMgD,EACNC,QAAS,CAAE9C,KAAI+C,QAAOjG,IAAGC,OC+RiCiG,YDpRvD,SAAqBhD,EAAI+C,GAC9B,MAAO,CACLlD,KAAMgD,EACNC,QAAS,CAAE9C,KAAI+C,YCiRJH,CAA6DzH,86BC5T5E,IAAM8H,EAAc,CAClBC,KAAQ,eACRC,QAAW,UAGPC,EAAYjJ,IAAOC,IAAViJ,IAIO,SAAA7I,GAAK,OAAIA,EAAM8I,OAAS,WAAa,UAKrDC,EAAapJ,IAAOC,IAAVoJ,KAUVC,EAAYtJ,IAAOC,IAAVsJ,KAUTC,EAAcxJ,IAAOC,IAAVwJ,IAIK,SAAApJ,GAAK,OAAIA,EAAMqJ,QAI/BC,GAAgB3J,IAAOC,IAAV2J,KAKbC,eACJ,SAAAA,EAAYxJ,GAAO,IAAAY,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAyI,IACjB5I,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAA2I,GAAAtI,KAAAH,KAAMf,KACDyJ,WAAa7I,EAAK6I,WAAWrI,KAAhBP,OAAAQ,EAAA,EAAAR,QAAAQ,EAAA,EAAAR,CAAAD,KAClBA,EAAK8I,OAAS9I,EAAK8I,OAAOtI,KAAZP,OAAAQ,EAAA,EAAAR,QAAAQ,EAAA,EAAAR,CAAAD,KACdA,EAAK+I,SAAW/I,EAAK+I,SAASvI,KAAdP,OAAAQ,EAAA,EAAAR,QAAAQ,EAAA,EAAAR,CAAAD,KAChBA,EAAKgJ,OAAShJ,EAAKgJ,OAAOxI,KAAZP,OAAAQ,EAAA,EAAAR,QAAAQ,EAAA,EAAAR,CAAAD,KACdA,EAAKiJ,iBAAmBjJ,EAAKiJ,iBAAiBzI,KAAtBP,OAAAQ,EAAA,EAAAR,QAAAQ,EAAA,EAAAR,CAAAD,KANPA,4EAUXG,KAAKf,MAAMiF,gBAAkBlE,KAAKf,MAAM8J,KAAKtE,GACjDzE,KAAKf,MAAM+J,iBAAiBhJ,KAAKf,MAAM8J,MAGvC/I,KAAKf,MAAM+J,iBAAiB,CAAEvE,GAAI,sCAI/BK,GACLA,EAAImB,kBACJjG,KAAKf,MAAMgK,cAAcjJ,KAAKf,MAAM8J,uCAG7BjE,GACPA,EAAImB,kBACJjG,KAAKf,MAAMiK,gBAAgBlJ,KAAKf,MAAM8J,qCAGjCjE,GACLA,EAAImB,kBACJjG,KAAKf,MAAMkK,cAAcnJ,KAAKf,MAAM8J,+CAGrBjE,GACf9E,KAAKf,MAAMmK,YAAYpJ,KAAKf,MAAM8J,KAAKtE,GAAIK,EAAIuE,OAAOC,wCAG/C,IAAAC,EAIHvJ,KAAKf,MAFP8J,EAFKQ,EAELR,KACA7E,EAHKqF,EAGLrF,cAEF,OACEuC,EAAAnB,EAAAoB,cAACmB,EAAD,CACEb,QAAShH,KAAK0I,WACdX,OAAQ7D,IAAkB6E,EAAKtE,IAE/BgC,EAAAnB,EAAAoB,cAACwB,EAAD,KACEzB,EAAAnB,EAAAoB,cAAA,QAAMQ,KAAK,MAAMC,aAAY4B,EAAKzE,MAAOoD,EAAYqB,EAAKzE,OAC1DmC,EAAAnB,EAAAoB,cAAA,SAAOpC,KAAK,OAAOgF,MAAOP,EAAKS,KAAMC,SAAUzJ,KAAK8I,oBAEtDrC,EAAAnB,EAAAoB,cAAC6B,GAAD,KACE9B,EAAAnB,EAAAoB,cAAC0B,EAAD,CAAaE,MAAO7K,EAAIsL,EAAKtH,OAAO,MACpCgF,EAAAnB,EAAAoB,cAAC0B,EAAD,CAAaE,MAAO7K,EAAIsL,EAAKtH,OAAO,OAEtCgF,EAAAnB,EAAAoB,cAACsB,EAAD,KACEvB,EAAAnB,EAAAoB,cAAA,UAAQM,QAAShH,KAAK2I,QACpBlC,EAAAnB,EAAAoB,cAAA,QAAMQ,KAAK,MAAMC,aAAW,mBAA5B,iBAEFV,EAAAnB,EAAAoB,cAAA,UAAQM,QAAShH,KAAK6I,QACpBpC,EAAAnB,EAAAoB,cAAA,QAAMQ,KAAK,MAAMC,aAAW,kBAA5B,uBAEFV,EAAAnB,EAAAoB,cAAA,UAAQM,QAAShH,KAAK4I,UACpBnC,EAAAnB,EAAAoB,cAAA,QAAMQ,KAAK,MAAMC,aAAW,qBAA5B,0BAhEkBC,aA8ExBsC,GAAqB,CACzBV,iBCrIK,SAA0BW,GAC/B,MAAO,CACLrF,KAAMgD,EACNC,QAASoC,EAAQlF,KDmInBwE,cFnHK,SAAuBU,GAC5B,MAAO,CACLrF,KAAMgD,EACNC,QAASoC,IEiHXT,gBF7GK,SAAyBS,GAC9B,MAAO,CACLrF,KAAMgD,EACNC,QAASoC,IE2GXR,cF5HK,SAAuBQ,GAC5B,MAAO,CACLrF,KAAMgD,EACNC,QAASoC,IE0HXP,YF5EK,SAAqB3E,EAAI+E,GAC9B,MAAO,CACLlF,KAAMgD,EACNC,QAAS,CAAC9C,KAAI+E,WE4EHnC,eAdS,SAAAvG,GACtB,MAAO,CACLoD,cAAepD,EAAMoD,gBAYewF,GAAzBrC,CAA6CoB,8NExI5D,IAAMmB,GAAahL,IAAOC,IAAVgL,MAUVC,oLACK,IACA7F,EAAYjE,KAAKf,MAAjBgF,SACP,OACEwC,EAAAnB,EAAAoB,cAACkD,GAAD,KAEI3F,EAAS8F,IAAI,SAAA1F,GAAG,OAAKoC,EAAAnB,EAAAoB,cAACsD,GAAD,CAAiBrD,IAAKtC,EAAII,GAAIsE,KAAM1E,cANzC+C,aAmBXC,eANS,SAAAvG,GACtB,MAAO,CACLmD,SAAUnD,EAAMmD,WAILoD,CAAyByC,oVC3BxC,IAAMG,GAAcrL,IAAOC,IAAVqL,MAOXC,GAASvL,IAAOC,IAAVuL,KAGU,SAAAnL,GAAK,OAAIA,EAAMqJ,OACpB,SAAArJ,GAAK,OAAIA,EAAM8I,OAAQ,SAAW,SAChC,SAAA9I,GAAK,OAAIA,EAAM8I,OAAQ,QAAU,SAG9CsC,eACJ,SAAAA,EAAYpL,GAAO,IAAAY,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAqK,IACjBxK,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAuK,GAAAlK,KAAAH,KAAMf,KACD6B,MAAQ,CACXwJ,aAAc,GAHCzK,yFAOOwB,GACxB,IAAM2C,EAAY3C,EAAU4C,SAAS2B,KAAK,SAAAvB,GAAG,OAAIA,EAAII,KAAOpD,EAAU6C,gBAClEF,GACFhE,KAAKsB,SAAS,CACZgJ,YAAatG,EAAUvC,OAAOJ,EAAUmG,0CAKrC,IAAA1D,EAAA9D,KAAAuJ,EACkCvJ,KAAKf,MAAvCiF,EADAqF,EACArF,cAAeqG,EADfhB,EACegB,SAAU/C,EADzB+B,EACyB/B,MAChC,OACEf,EAAAnB,EAAAoB,cAACuD,GAAD,KAEIxM,EAAIsM,IAAI,SAACS,EAAKC,GAAN,OACNhE,EAAAnB,EAAAoB,cAACyD,GAAD,CAAQ7B,MAAOkC,EAAK7D,IAAK8D,EAAY1C,OAAQjE,EAAKhD,MAAMwJ,cAAgBG,EACtEzD,QAAS,WAAOuD,EAASrG,EAAeuG,EAAYjD,gBAxBvCJ,aAwCZC,eAPS,SAAAvG,GACtB,MAAO,CACLoD,cAAepD,EAAMoD,cACrBD,SAAUnD,EAAMmD,WAIoB,CAACsG,SLPlC,SAAkB9F,EAAI6D,EAAOd,GAClC,MAAO,CACLlD,KAAMgD,EACNC,QAAS,CAAE9C,KAAI6D,QAAOd,YKIXH,CAAqCgD,sPCzDpD,IAAMK,GAAO9L,IAAOC,IAAV8L,MAKJC,GAAQhM,IAAOiM,MAAVC,MAOLC,eACJ,SAAAA,EAAY9L,GAAM,IAAAY,EAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAA+K,GAChBlL,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAiL,GAAA5K,KAAAH,KAAMf,IAEN,IAAM+E,EAAY/E,EAAMgF,SAAS2B,KAAK,SAAAvB,GAAG,OAAIA,EAAII,KAAOxF,EAAMiF,gBAH9C,OAKdrE,EAAKiB,MADHkD,EACU,CACVgH,OAAOlL,OAAAqE,EAAA,EAAArE,CAAKkE,EAAUtC,UAIX,CAACsJ,OAAO,EACnB,GAAO,GAAO,GAAO,GACrB,GAAO,GAAO,GAAO,GACrB,GAAO,GAAO,GAAO,GACrB,GAAO,GAAO,GAAO,IAGzBnL,EAAKoL,YAAcpL,EAAKoL,YAAY5K,KAAjBP,OAAAQ,EAAA,EAAAR,QAAAQ,EAAA,EAAAR,CAAAD,KAjBHA,yFAmBQwB,GACxB,IAAM2C,EAAY3C,EAAU4C,SAAS2B,KAAK,SAAAvB,GAAG,OAAIA,EAAII,KAAOpD,EAAU6C,gBAClEF,GACFhE,KAAKsB,SAAS,CACZ0J,OAAOlL,OAAAqE,EAAA,EAAArE,CAAKkE,EAAUtC,+CAIhB8F,GACVxH,KAAKf,MAAMiM,WAAWlL,KAAKf,MAAMiF,cAAelE,KAAKc,MAAMkK,OAAOjB,IAAI,SAACvK,EAAK2L,GAC1E,OAAIA,IAAa3D,GACPhI,EAEHA,sCAIF,IAAAsE,EAAA9D,KACP,OACEyG,EAAAnB,EAAAoB,cAACgE,GAAD,KAEI1K,KAAKc,MAAMkK,OAAOjB,IAAI,SAACT,EAAO9B,GAAR,OACpBf,EAAAnB,EAAAoB,cAACkE,GAAD,CAAOtG,KAAK,WAAWqC,IAAKa,EAAO4D,QAAS9B,EAAOG,SAAU,WAAO3F,EAAKmH,YAAYzD,gBA1CrEJ,aAyDbC,eAPS,SAAAvG,GACtB,MAAO,CACLoD,cAAepD,EAAMoD,cACrBD,SAAUnD,EAAMmD,WAIoB,CAACiH,WNLlC,SAAoBzG,EAAI/C,GAC7B,MAAO,CACL4C,KAAMgD,EACNC,QAAS,CAAC9C,KAAI/C,cMEH2F,CAAuC0D,gsBChEtD,IAAMM,GAAYzM,IAAOC,IAAVyM,MAaTC,GAAc3M,IAAOC,IAAV2M,MAOXC,GAAa7M,IAAO8M,OAAVC,KAGE,SAAA1M,GAAK,OAAIA,EAAM8I,OAAS,OAAS,SAG7C6D,GAAUhN,IAAOC,IAAVgN,MAIPC,oLAEK,IAAAvC,EAQDvJ,KAAKf,MANT8M,EAFKxC,EAELwC,WACA7H,EAHKqF,EAGLrF,cACA8H,EAJKzC,EAILyC,eACA7F,EALKoD,EAKLpD,YACA8F,EANK1C,EAML0C,cACAC,EAPK3C,EAOL2C,UAEF,OACEzF,EAAAnB,EAAAoB,cAAC2E,GAAD,KACE5E,EAAAnB,EAAAoB,cAAC6E,GAAD,KACE9E,EAAAnB,EAAAoB,cAACkF,GAAD,KACAnF,EAAAnB,EAAAoB,cAAC+E,GAAD,CACEzE,QAAS,WAAO+E,EAAW,UAC3BtF,EAAAnB,EAAAoB,cAAA,QAAMQ,KAAK,MAAMC,aAAW,YAA5B,0BAEFV,EAAAnB,EAAAoB,cAAC+E,GAAD,CACEzE,QAAS,WAAO+E,EAAW,aAC3BtF,EAAAnB,EAAAoB,cAAA,QAAMQ,KAAK,MAAMC,aAAW,eAA5B,uBAEFV,EAAAnB,EAAAoB,cAAC+E,GAAD,CACEzE,QAAS,WAAOiF,MAChBxF,EAAAnB,EAAAoB,cAAA,QAAMQ,KAAK,MAAMC,aAAW,kBAA5B,sCAEFV,EAAAnB,EAAAoB,cAAC+E,GAAD,CACEzE,QAAS,WAAOkF,MAChBzF,EAAAnB,EAAAoB,cAAA,QAAMQ,KAAK,MAAMC,aAAW,qBAA5B,gCAGFV,EAAAnB,EAAAoB,cAACkF,GAAD,KAEoB,OAAlB1H,GACEuC,EAAAnB,EAAAoB,cAACyF,EAAA,SAAD,KACE1F,EAAAnB,EAAAoB,cAAC+E,GAAD,CACEzE,QAAS,WAAOgF,EAAe,eAAgBjE,OAAwB,eAAhB5B,GACvDM,EAAAnB,EAAAoB,cAAA,QAAMQ,KAAK,MAAMC,aAAW,cAA5B,sBAEFV,EAAAnB,EAAAoB,cAAC+E,GAAD,CACEzE,QAAS,WAAOgF,EAAe,gBAAiBjE,OAAwB,gBAAhB5B,GACxDM,EAAAnB,EAAAoB,cAAA,QAAMQ,KAAK,MAAMC,aAAW,eAA5B,gCAOVV,EAAAnB,EAAAoB,cAAC6E,GAAD,KACE9E,EAAAnB,EAAAoB,cAAC0F,GAAD,CAAc5E,MAAO,IACrBf,EAAAnB,EAAAoB,cAAC0F,GAAD,CAAc5E,MAAO,KAEvBf,EAAAnB,EAAAoB,cAAC6E,GAAD,KACE9E,EAAAnB,EAAAoB,cAAC2F,GAAD,eAtDiBjF,aAoEZC,eAPS,SAAAvG,GACtB,MAAO,CACLoD,cAAepD,EAAMoD,cACrBiC,YAAarF,EAAMqF,cAIiB,CAAC4F,WPzGlC,SAAoBzH,GACzB,MAAO,CACLA,KAAMgD,EACNC,QAAS,CACPjD,OACAG,KAAM/F,KOoGyCuN,cPhC9C,WACL,MAAO,CACL3H,KAAMgD,EACNC,QAAS,CACPjD,KAAM,UACNG,KAAM/F,KO2BwDsN,eC3G7D,SAAwBM,GAC7B,MAAO,CACLhI,KAAMgD,EACNC,QAAS+E,IDwGuEJ,UE3G7E,WACL,MAAO,CACL5H,KAAMgD,KFyGKD,CAAiFyE,q0BGtGhG,IAAMS,GAAU3N,IAAOC,IAAV2N,MAYPC,GAAc7N,IAAOC,IAAV6N,MAMXC,GAAS/N,IAAOC,IAAV+N,MAWNC,GAAOjO,IAAOC,IAAViO,MAIJC,GAAanO,IAAOC,IAAVmO,MAIVC,eACJ,SAAAA,EAAYhO,GAAO,IAAAY,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAE,KAAAiN,IACjBpN,EAAAC,OAAAG,EAAA,EAAAH,CAAAE,KAAAF,OAAAI,EAAA,EAAAJ,CAAAmN,GAAA9M,KAAAH,KAAMf,KACDiO,UAAYrN,EAAKqN,UAAU7M,KAAfP,OAAAQ,EAAA,EAAAR,QAAAQ,EAAA,EAAAR,CAAAD,KACjBA,EAAKsN,WAAatN,EAAKsN,WAAW9M,KAAhBP,OAAAQ,EAAA,EAAAR,QAAAQ,EAAA,EAAAR,CAAAD,KAHDA,0EAMRiF,GAAK,IAAAhB,EAAA9D,KACRoN,EAAS,IAAIC,WACnBD,EAAOE,OAAS,SAACC,GACf,IAAMC,EAAOC,KAAKC,MAAMH,EAAQlE,OAAOsE,QACvC7J,EAAK7E,MAAM2O,YAAYJ,GACvB1J,EAAK7E,MAAM4O,cAEbT,EAAOU,WAAWhJ,EAAIuE,OAAO0E,MAAM,6CAGpB/C,GACf,IAAIgD,EAAQ,EAWZ,OAVAhD,EAAO5G,QAAQ,SAAC6J,EAAGxJ,GACjB,IAAIyJ,EAAI,EACJD,GAAKxJ,EAAK,EACZyJ,EAAIvO,KAAK6F,IAAI,EAAE,GAAGf,GAEXwJ,IACPC,GAAK,OAEPF,GAASE,IAEJF,yCAGMG,GAAM,IAAA1I,EAAAzF,KACnB,OAAOmO,EAAKpE,IAAI,SAAA1F,GACd,IAAI+J,EAAM,GACO,YAAb/J,EAAIC,KACN8J,GAAO,QAEa,SAAb/J,EAAIC,OACX8J,GAAO,SAET,IAAIC,EAAU,GAAKhK,EAAI5C,OAAO,GAAK4C,EAAI5C,OAAO,GACxC6M,EAAc7I,EAAK8I,iBAAiBlK,EAAI3C,SAE9C,OADA0M,GAAG,IAAAxL,OAAQyB,EAAIG,OAAOgK,KAAK,KAAxB,SAAA5L,OAAoCyL,EAAOI,SAAS,IAApD,MAAA7L,OAA4D0L,EAA5D,2CAKGxJ,GACRA,EAAImB,kBACJjG,KAAKf,MAAM4O,8CAGJ,IAAAtE,EACuBvJ,KAAKf,MAA5BgF,EADAsF,EACAtF,SACP,IAFOsF,EACUmF,UACD,OAAO,KAEvB,IAAMC,EAAW,IAAIC,KAAK,CAACnB,KAAKoB,UAAU5K,EAAU,KAAM,IAAK,CAAEK,KAAM,qBACjEwK,EAAW,IAAIF,KAAK5O,KAAK+O,eAAe9K,GAAW,CAAEK,KAAM,eAC3D0K,EAAUC,OAAOC,IAAIC,gBAAgBR,GACrCS,EAAUH,OAAOC,IAAIC,gBAAgBL,GAE3C,OACErI,EAAAnB,EAAAoB,cAAC6F,GAAD,KACE9F,EAAAnB,EAAAoB,cAAC+F,GAAD,KACEhG,EAAAnB,EAAAoB,cAACiG,GAAD,KACElG,EAAAnB,EAAAoB,cAAA,mCAGAD,EAAAnB,EAAAoB,cAACqG,GAAD,CAAY/F,QAAShH,KAAKkN,WAAWzG,EAAAnB,EAAAoB,cAAA,QAAMQ,KAAK,MAAMC,aAAW,qBAA5B,YAEvCV,EAAAnB,EAAAoB,cAACmG,GAAD,KACEpG,EAAAnB,EAAAoB,cAAA,yBACeD,EAAAnB,EAAAoB,cAAA,SAAOpC,KAAK,OAAOmF,SAAUzJ,KAAKmN,cAEjD1G,EAAAnB,EAAAoB,cAAA,SACED,EAAAnB,EAAAoB,cAAA,KAAG2I,SAAS,sBAAsBC,KAAMN,GAAxC,kBAEFvI,EAAAnB,EAAAoB,cAAA,SACED,EAAAnB,EAAAoB,cAAA,KAAG2I,SAAS,qBAAqBC,KAAMF,GAAvC,mCA/EYhI,aA+FXC,eAPS,SAAAvG,GACtB,MAAO,CACLmD,SAAUnD,EAAMmD,SAChByK,UAAW5N,EAAM4N,YAImB,CAACb,WDnIlC,WACL,MAAO,CACLvJ,KAAMgD,ICiI2CsG,YVpD9C,SAAqB3J,GAC1B,MAAO,CACLK,KAAMgD,EACNC,QAAStD,KUiDEoD,CAAoD4F,oaClInE,IAAMsC,GAAM3Q,IAAOC,IAAV2Q,MAUH9E,GAAO9L,IAAOC,IAAV4Q,MAUJC,oLAEF,OACEjJ,EAAAnB,EAAAoB,cAACiJ,GAAD,KACElJ,EAAAnB,EAAAoB,cAAC6I,GAAD,KACE9I,EAAAnB,EAAAoB,cAACkJ,EAAD,MACAnJ,EAAAnB,EAAAoB,cAACmJ,GAAD,OAEFpJ,EAAAnB,EAAAoB,cAACoJ,GAAD,MACArJ,EAAAnB,EAAAoB,cAACqJ,GAAD,cATU3I,aAmBHC,eAJS,SAAAvG,GACtB,MAAO,IAGMuG,CAAyBqI,ICpCpBM,QACW,cAA7Bf,OAAOgB,SAASC,UAEe,UAA7BjB,OAAOgB,SAASC,UAEhBjB,OAAOgB,SAASC,SAASC,MACvB,iFClBSC,GAAA,CACbnM,SAAU,CACR,CACEQ,GAAI,MACJ+E,KAAM,aACNlF,KAAM,UACNE,OAAQ,CACN,EAAG,EAAG,IAAK,EAAG,IAAK,IAAK,EAAG,KAE7B/C,OAAQ,CAAC,EAAE,GACXC,QAAS,EACP,GAAM,GAAM,GAAO,GACnB,GAAM,GAAM,GAAO,GACnB,GAAO,GAAO,GAAM,GACpB,GAAO,GAAO,GAAM,KAI1BwC,cAAe,KACfiC,YAAa,cACbuI,WAAW,GCbE2B,oBAAgB,CAC7BpM,SCLa,WAAgE,IAAvCnD,EAAuCwP,UAAAtN,OAAA,QAAAuN,IAAAD,UAAA,GAAAA,UAAA,GAA/BF,GAAanM,SAAUuM,EAAQF,UAAAtN,OAAA,EAAAsN,UAAA,QAAAC,EAC7E,OAAQC,EAAOlM,MAEb,KAAKgD,EACH,SAAA1E,OAAA9C,OAAAqE,EAAA,EAAArE,CACKgB,GADL,CAEE,CACE2D,GAAI+L,EAAOjJ,QAAQ9C,GACnB+E,KAAI,OAAA5G,OAAS4N,EAAOjJ,QAAQ9C,IAC5BH,KAAMkM,EAAOjJ,QAAQjD,KACrBE,OAAQ,GACR/C,OAAQ,CAAC,EAAE,GACXC,QAAS,EACP,GAAO,GAAO,GAAO,GACrB,GAAO,GAAO,GAAO,GACrB,GAAO,GAAO,GAAO,GACrB,GAAO,GAAO,GAAO,MAK7B,KAAK4F,EACH,OAAOxH,OAAAqE,EAAA,EAAArE,CACFgB,EAAM2P,OAAO,SAAAC,GAAI,OAAIA,EAAKjM,KAAO+L,EAAOjJ,QAAQ9C,MAGrD,KAAK6C,EACL,OACE,CACE7C,GAAI+L,EAAOjJ,QAAQ9C,GACnB+E,KAAI,cAAA5G,OAAgB4N,EAAOjJ,QAAQ9C,IACnCH,KAAMkM,EAAOjJ,QAAQjD,KACrBE,OAAQ,CAAC,EAAE,EAAG,IAAI,EAAG,IAAI,IAAK,EAAE,KAChC/C,OAAQ,CAAC,EAAE,GACXC,QAAS,EACP,GAAO,GAAO,GAAO,GACrB,GAAO,GAAO,GAAO,GACrB,GAAO,GAAO,GAAO,GACrB,GAAO,GAAO,GAAO,KAX3BkB,OAAA9C,OAAAqE,EAAA,EAAArE,CAcKgB,IAGP,KAAKwG,EACH,IAAIqJ,EAAgB7P,EAAM8P,UAAU,SAAAvM,GAAG,OAAIA,EAAII,KAAO+L,EAAOjJ,QAAQ9C,KACrE,GAAIkM,GAAiB,EAEnB,OAAO7Q,OAAAqE,EAAA,EAAArE,CAAIgB,GAEb,IAAI+P,EAAW/P,EAAM6P,GACrB,SAAA/N,OAAA9C,OAAAqE,EAAA,EAAArE,CACKgB,EAAMgQ,MAAM,EAAGH,EAAc,IADlC,CAAA7Q,OAAAiR,GAAA,EAAAjR,CAAA,GAEO+Q,GAFP/Q,OAAAiR,GAAA,EAAAjR,CAAA,GAGMgB,EAAM6P,EAAc,KAH1B7Q,OAAAqE,EAAA,EAAArE,CAIKgB,EAAMgQ,MAAMH,EAAc,KAIjC,KAAKrJ,EACH,IAAIqJ,EAAgB7P,EAAM8P,UAAU,SAAAvM,GAAG,OAAIA,EAAII,KAAO+L,EAAOjJ,QAAQ9C,KACrE,GAAIkM,EAAe,GAAKA,IAAkB7P,EAAMkC,OAAO,EAErD,OAAOlD,OAAAqE,EAAA,EAAArE,CAAIgB,GAEb,IAAI+P,EAAW/P,EAAM6P,GACrB,SAAA/N,OAAA9C,OAAAqE,EAAA,EAAArE,CACKgB,EAAMgQ,MAAM,EAAGH,IADpB,CAAA7Q,OAAAiR,GAAA,EAAAjR,CAAA,GAEMgB,EAAM6P,EAAc,IAF1B7Q,OAAAiR,GAAA,EAAAjR,CAAA,GAGO+Q,IAHP/Q,OAAAqE,EAAA,EAAArE,CAIKgB,EAAMgQ,MAAMH,EAAc,KAIjC,KAAKrJ,EAAkB,IAAA0J,EACKR,EAAOjJ,QAA1B9C,EADcuM,EACdvM,GAAI+C,EADUwJ,EACVxJ,MAAOjG,EADGyP,EACHzP,EAAGC,EADAwP,EACAxP,EACrB,OAAOV,EAAMiJ,IAAI,SAAA1F,GACf,OAAIA,EAAII,KAAOA,EACN3E,OAAAiR,GAAA,EAAAjR,CAAA,GACFuE,EADL,CAEEG,OAAQH,EAAIG,OAAOuF,IAAI,SAAChE,EAAIkL,GAC1B,OAAIA,IAAQzJ,EACHjG,EAED0P,IAAQzJ,EAAM,EACbhG,EAEFuE,MAIN1B,IAIX,KAAKiD,EAAiB,IAAA4J,EACDV,EAAOjJ,QAAnB9C,EADayM,EACbzM,GAAIlD,EADS2P,EACT3P,EAAGC,EADM0P,EACN1P,EACd,OAAOV,EAAMiJ,IAAI,SAAA1F,GACf,OAAIA,EAAII,KAAOA,EACN3E,OAAAiR,GAAA,EAAAjR,CAAA,GACFuE,EADL,CAEEG,OAAM,GAAA5B,OAAA9C,OAAAqE,EAAA,EAAArE,CACDuE,EAAIG,QADH,CAEJjD,EACAC,MAIC6C,IAIX,KAAKiD,EAAoB,IAAA6J,EACHX,EAAOjJ,QAApB9C,EADgB0M,EAChB1M,GAAI+C,EADY2J,EACZ3J,MACX,OAAO1G,EAAMiJ,IAAI,SAAA1F,GACf,OAAIA,EAAII,KAAOA,EACN3E,OAAAiR,GAAA,EAAAjR,CAAA,GACFuE,EADL,CAEEG,OAAQH,EAAIG,OAAO4M,OAAO5J,EAAO,KAG9BnD,IAIX,KAAKiD,EAAiB,IAAA+J,EACOb,EAAOjJ,QAA3B9C,EADa4M,EACb5M,GAAI6D,EADS+I,EACT/I,MAAOd,EADE6J,EACF7J,MAClB,OAAO1G,EAAMiJ,IAAI,SAAA1F,GACf,OAAIA,EAAII,KAAOA,EACN3E,OAAAiR,GAAA,EAAAjR,CAAA,GACFuE,EADL,CAEE5C,OAAQ4C,EAAI5C,OAAOsI,IAAI,SAACuH,EAASC,GAC/B,OAAI/J,IAAU+J,EACLjJ,EAEFgJ,MAINjN,IAIX,KAAKiD,EAAoB,IAAAkK,EACJhB,EAAOjJ,QAAnB9C,EADgB+M,EAChB/M,GAAI+E,EADYgI,EACZhI,KACX,OAAO1I,EAAMiJ,IAAI,SAAA1F,GACf,OAAIA,EAAII,KAAOA,EACN3E,OAAAiR,GAAA,EAAAjR,CAAA,GACFuE,EADL,CAEEmF,SAGGnF,IAIX,KAAKiD,EAAmB,IAAAmK,EACAjB,EAAOjJ,QAAtB9C,EADegN,EACfhN,GAAI/C,EADW+P,EACX/P,QACX,OAAOZ,EAAMiJ,IAAI,SAAA1F,GACf,OAAIA,EAAII,KAAOA,EACN3E,OAAAiR,GAAA,EAAAjR,CAAA,GACFuE,EADL,CAEE3C,QAAQ5B,OAAAqE,EAAA,EAAArE,CAAK4B,KAGV2C,IAIX,KAAKiD,EAEH,OAAOxH,OAAAqE,EAAA,EAAArE,CACF0Q,EAAOjJ,SAId,QACE,OAAOzG,ID3KXoD,cENa,WAA0E,IAA5CpD,EAA4CwP,UAAAtN,OAAA,QAAAuN,IAAAD,UAAA,GAAAA,UAAA,GAApCF,GAAalM,cAAesM,EAAQF,UAAAtN,OAAA,EAAAsN,UAAA,QAAAC,EACvF,OAAQC,EAAOlM,MAEb,KAAKgD,EACH,OAAOkJ,EAAOjJ,QAGhB,KAAKD,EACH,OAAOkJ,EAAOjJ,QAAQ9C,GAExB,KAAK6C,EACH,OAAQkJ,EAAOjJ,QAAQ9C,KAAO3D,EAAS,KAAOA,EAGhD,QACE,OAAOA,IFRXqF,YGPa,WAAsE,IAA1CrF,EAA0CwP,UAAAtN,OAAA,QAAAuN,IAAAD,UAAA,GAAAA,UAAA,GAAlCF,GAAajK,YAAaqK,EAAQF,UAAAtN,OAAA,EAAAsN,UAAA,QAAAC,EACnF,OAAQC,EAAOlM,MAEb,KAAKgD,EACH,OAAOkJ,EAAOjJ,QAEhB,KAAKD,EACH,MAAO,cAET,KAAKA,EACH,MAAO,aAET,QACE,OAAOxG,IHLX4N,UIRa,WAA8D,IAAxC5N,EAAwCwP,UAAAtN,OAAA,QAAAuN,IAAAD,UAAA,GAAAA,UAAA,GAAhCF,GAAa1B,UACxD,QAD2E4B,UAAAtN,OAAA,EAAAsN,UAAA,QAAAC,GAC5DjM,MAEb,KAAKgD,EACH,OAAO,EAET,KAAKA,EACH,OAAO,EAET,QACE,OAAOxG,MCTE4Q,gBACbC,GACAvB,GACAnB,OAAO2C,8BAAgC3C,OAAO2C,gCCC1CC,GAAcC,SAASC,eAAe,QAE5CC,IAASC,OACPxL,EAAAnB,EAAAoB,cAACwL,EAAA,EAAD,CAAUC,MAAOA,IACf1L,EAAAnB,EAAAoB,cAAC0L,GAAD,OAECP,IRmHC,kBAAmBQ,WACrBA,UAAUC,cAAcC,MAAMC,KAAK,SAAAC,GACjCA,EAAaC","file":"static/js/main.e43ca7f8.chunk.js","sourcesContent":["// PICO-8 Colors\r\n\r\nexport const hex = [\r\n  '#000000', // black\r\n  '#1D2B53', // dark blue\r\n  '#7E2553', // purple\r\n  '#008751', // dark green\r\n  '#AB5236', // brown\r\n  '#5F574F', // dark gray\r\n  '#C2C3C7', // light gray\r\n  '#FFF1E8', // white\r\n  '#FF004D', // red\r\n  '#FFA300', // orange\r\n  '#FFEC27', // yellow\r\n  '#00E436', // green\r\n  '#29ADFF', // blue\r\n  '#83769C', // indigo\r\n  '#FF77A8', // pink\r\n  '#FFCCAA'  // peach\r\n];\r\n\r\nexport const rgb = [\r\n  [0, 0, 0],\r\n  [29, 43, 83],\r\n  [126, 37, 83],\r\n  [0, 135, 81],\r\n  [171, 82, 54],\r\n  [95, 87, 79],\r\n  [194, 195, 199],\r\n  [255, 241, 232],\r\n  [255, 0, 77],\r\n  [255, 163, 0],\r\n  [255, 236, 39],\r\n  [0, 228, 54],\r\n  [41, 173, 255],\r\n  [131, 118, 156],\r\n  [255, 119, 168],\r\n  [255, 204, 170]\r\n];","export const ADD_COMMAND = 'ADD_COMMAND';\r\nexport const REMOVE_COMMAND = 'REMOVE_COMMAND';\r\nexport const MOVE_COMMAND_UP = 'MOVE_COMMAND_UP';\r\nexport const MOVE_COMMAND_DOWN = 'MOVE_COMMAND_DOWN';\r\nexport const MOVE_POINT = 'MOVE_POINT';\r\nexport const ADD_POINT = 'ADD_POINT';\r\nexport const REMOVE_POINT = 'REMOVE_POINT';\r\nexport const SET_COLOR = 'SET_COLOR';\r\nexport const NAME_COMMAND = 'NAME_COMMAND';\r\nexport const SET_PATTERN = 'SET_PATTERN';\r\nexport const ADD_BACKGROUND = 'ADD_BACKGROUND';\r\nexport const SET_COMMANDS = 'SET_COMMANDS';\r\n\r\nexport const SET_ACTIVE_COMMAND = 'SET_ACTIVE_COMMAND';\r\n\r\nexport const SET_DRAWING_MODE = 'SET_DRAWING_MODE';\r\n\r\nexport const OPEN_MODAL = 'OPEN_MODAL';\r\nexport const CLOSE_MODAL = 'CLOSE_MODAL';","import * as types from './actionTypes';\r\n\r\nlet commandCount = 0;\r\n\r\nexport function addCommand(type) {\r\n  return {\r\n    type: types.ADD_COMMAND,\r\n    payload: {\r\n      type,\r\n      id: ++commandCount\r\n    }\r\n  };\r\n}\r\n\r\nexport function removeCommand(command) {\r\n  return {\r\n    type: types.REMOVE_COMMAND,\r\n    payload: command\r\n  }\r\n}\r\n\r\nexport function moveCommandUp(command) {\r\n  return {\r\n    type: types.MOVE_COMMAND_UP,\r\n    payload: command\r\n  }\r\n}\r\n\r\nexport function moveCommandDown(command) {\r\n  return {\r\n    type: types.MOVE_COMMAND_DOWN,\r\n    payload: command\r\n  }\r\n}\r\n\r\nexport function movePoint(id, index, x, y) {\r\n  return {\r\n    type: types.MOVE_POINT,\r\n    payload: { id, index, x, y }\r\n  };\r\n}\r\n\r\nexport function addPoint(id, x, y) {\r\n  return {\r\n    type: types.ADD_POINT,\r\n    payload: { id, x, y }\r\n  };\r\n}\r\n\r\nexport function removePoint(id, index) {\r\n  return {\r\n    type: types.REMOVE_POINT,\r\n    payload: { id, index }\r\n  };\r\n}\r\n\r\nexport function setColor(id, color, index) {\r\n  return {\r\n    type: types.SET_COLOR,\r\n    payload: { id, color, index }\r\n  };\r\n}\r\n\r\nexport function nameCommand(id, name) {\r\n  return {\r\n    type: types.NAME_COMMAND,\r\n    payload: {id, name}\r\n  }\r\n}\r\n\r\nexport function setPattern(id, pattern) {\r\n  return {\r\n    type: types.SET_PATTERN,\r\n    payload: {id, pattern}\r\n  }\r\n}\r\n\r\nexport function addBackground() {\r\n  return {\r\n    type: types.ADD_BACKGROUND,\r\n    payload: {\r\n      type: 'POLYGON',\r\n      id: ++commandCount\r\n    }\r\n  }\r\n}\r\n\r\nexport function setCommands(commands) {\r\n  return {\r\n    type: types.SET_COMMANDS,\r\n    payload: commands\r\n  }\r\n}","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport {hex} from '../utils/colors';\r\n\r\nimport {addPoint, movePoint, removePoint} from '../actions/commands';\r\n\r\nconst CanvasFrame = styled.div`\r\n  position: relative;\r\n  flex: 1;\r\n  height: 100%;\r\n  overflow: scroll;\r\n  display: flex;\r\n  justify-content: flex-start;\r\n  align-items: flex-start;\r\n  background-color: darkgray;\r\n  margin-right: 10px;\r\n`;\r\n\r\nconst ZoomCtrls = styled.div`\r\n  position: absolute;\r\n  display: ${props => props.dragging ? 'none' : 'block' };\r\n  z-index: 3;\r\n  left: 10px;\r\n  top: 10px;\r\n`;\r\n\r\nconst PixelCanvas = styled.canvas`\r\n  width: ${props => props.scale}px;\r\n  height: ${props => props.scale}px;\r\n  image-rendering: optimizeSpeed;\r\n  image-rendering: -moz-crisp-edges;\r\n  image-rendering: -webkit-optimize-contrast;\r\n  image-rendering: optimize-contrast;\r\n  image-rendering: pixelated;\r\n  -ms-interpolation-mode: nearest-neighbor;\r\n  z-index: 1;\r\n  background-color: white;\r\n  flex-shrink: 0;\r\n  margin: 50px;\r\n  box-shadow: 0px 10px 20px rgba(0,0,0,0.2);\r\n`;\r\n\r\nfunction clamp(val, min, max) {\r\n  return Math.max(Math.min(max, val), min);\r\n}\r\n\r\nclass Canvas extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.renderCanvas = this.renderCanvas.bind(this);\r\n    this.handleMouseDown = this.handleMouseDown.bind(this);\r\n    this.handleMouseMove = this.handleMouseMove.bind(this);\r\n    this.handleMouseUp = this.handleMouseUp.bind(this);\r\n    this.handleClick = this.handleClick.bind(this);\r\n    this.handleContextMenu = this.handleContextMenu.bind(this);\r\n    this.zoomIn = this.zoomIn.bind(this);\r\n    this.zoomOut = this.zoomOut.bind(this);\r\n\r\n    this.state = {\r\n      dragIndex: -1,\r\n      scale: 512\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.refs.canvas.width = 128;\r\n    this.refs.canvas.height = 128;\r\n    this.ctx = this.refs.canvas.getContext('2d');\r\n    this.renderCanvas(this.props);\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    this.renderCanvas(nextProps);\r\n  }\r\n\r\n  zoomIn() {\r\n    this.setState({\r\n      scale: this.state.scale * 2\r\n    });\r\n  }\r\n\r\n  zoomOut() {\r\n    this.setState({\r\n      scale: this.state.scale / 2\r\n    });\r\n  }\r\n\r\n  fillPattern(x, y, colors, pattern) {\r\n    const px = x % 4;\r\n    const py = y % 4;\r\n    const pc = py * 4 + px;\r\n    const pf = pattern[pc];\r\n    this.ctx.fillStyle = hex[colors[pf ? 1 : 0]];\r\n    this.ctx.fillRect(x, y,1,1);\r\n  }\r\n\r\n  // based on http://members.chello.at/~easyfilter/bresenham.html\r\n  bresenham(x0, y0, x1, y1, colors, pattern) {\r\n    const dx = Math.abs(x1 - x0);\r\n    const dy = -Math.abs(y1 - y0);\r\n    const sx = (x0 < x1) ? 1 : -1;\r\n    const sy = (y0 < y1) ? 1 : -1;\r\n    let x = x0, y = y0;\r\n    let err = dx + dy;\r\n    let e2;\r\n    let loopCt = 0;\r\n    do {\r\n      loopCt++;\r\n      if (loopCt > 500) {\r\n        console.error(`error drawing line ${x0}, ${y0} to ${x1}, ${y1}`);\r\n        break;\r\n      }\r\n      this.fillPattern(x,y, colors, pattern);\r\n      if ((x===x1) && (y===y1)) break;\r\n      e2 = 2 * err;\r\n      if (e2 >= dy) {\r\n        err += dy;\r\n        x += sx;\r\n      }\r\n      if (e2 <= dx) {\r\n        err += dx;\r\n        y += sy;\r\n      }\r\n    } while (true);\r\n  }\r\n\r\n  polygon(pts, colors, pattern) {\r\n    // http://alienryderflex.com/polygon_fill/\r\n    const polyCorners = pts.length / 2;\r\n    const polyX = [];\r\n    const polyY = [];\r\n    // sort out XY arrays\r\n    for (let h=0; h<pts.length; h+=2) {\r\n      polyX.push(pts[h]);\r\n      polyY.push(pts[h+1]);\r\n    }\r\n    //build node list\r\n    for (let y=0; y<this.refs.canvas.height; y++) {\r\n      const nodeX = [];\r\n      let nodes = 0;\r\n      let j = polyCorners - 1;\r\n      for (let i=0; i<polyCorners; i++) {\r\n        if (\r\n          ((polyY[i] < y) && (polyY[j] >= y)) ||\r\n          ((polyY[j] < y) && (polyY[i] >= y))\r\n        ) {\r\n          nodeX[nodes++] = (\r\n            polyX[i] +\r\n            Math.round((y-polyY[i])/(polyY[j]-polyY[i] + 0.0001) * // fudge for 0/0\r\n            (polyX[j] - polyX[i]))\r\n          );\r\n        }\r\n        j = i;\r\n      }\r\n      // sort nodes\r\n      let k=0;\r\n      while(k < nodes-1) {\r\n        if (nodeX[k] > nodeX[k+1]) {\r\n          let swap = nodeX[k];\r\n          nodeX[k] = nodeX[k+1];\r\n          nodeX[k+1] = swap;\r\n          if (k) k--;\r\n        }\r\n        else {\r\n          k++;\r\n        }\r\n      }\r\n      // fill the pixels between pairs\r\n      for (let l=0; l<nodes; l+=2) {\r\n        if (nodeX[l] >= this.refs.canvas.width) break;\r\n        if (nodeX[l+1] > 0) {\r\n          if (nodeX[l] < 0) nodeX[l] = 0;\r\n          if (nodeX[l+1] > this.refs.canvas.width) nodeX[l+1] = this.refs.canvas.width-1;\r\n          this.bresenham(nodeX[l], y, nodeX[l+1], y, colors, pattern);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  renderCanvas(props) {\r\n    this.ctx.clearRect(0, 0, this.refs.canvas.width, this.refs.canvas.height);\r\n    const {commands, activeCommand} = props;\r\n    const cmds = [...commands];//.reverse();\r\n    let activeCmd;\r\n    cmds.forEach(cmd => {\r\n      switch(cmd.type) {\r\n        case 'POLYGON': {\r\n          this.polygon(cmd.points, cmd.colors, cmd.pattern);\r\n          break;\r\n        }\r\n        case 'LINE': {\r\n          for (let i = 0; i < cmd.points.length-3; i+=2) {\r\n            const x0 = cmd.points[i];\r\n            const y0 = cmd.points[i+1];\r\n            const x1 = cmd.points[i+2];\r\n            const y1 = cmd.points[i+3];\r\n            this.bresenham(x0, y0, x1, y1, cmd.colors, cmd.pattern);\r\n          }\r\n          break;\r\n        }\r\n        default:\r\n          return;\r\n      }\r\n      if(cmd.id === activeCommand) {\r\n        activeCmd = cmd;\r\n      }\r\n    });\r\n    if(activeCmd) {\r\n      // draw points\r\n      this.ctx.globalCompositeOperation = 'xor';\r\n      this.ctx.strokeStyle = hex[activeCmd.colorId];\r\n      for (let i=0; i< activeCmd.points.length; i+=2) {\r\n        const x = activeCmd.points[i] - 0.5;\r\n        const y = activeCmd.points[i+1] - 0.5;\r\n        this.ctx.strokeRect(x-1, y-1, 2, 2);\r\n      }\r\n      this.ctx.globalCompositeOperation = 'source-over';\r\n    }\r\n  }\r\n\r\n  convert(evt) {\r\n    const rect = this.refs.canvas.getBoundingClientRect();\r\n    return {\r\n      x: clamp(Math.floor(this.refs.canvas.width * (evt.clientX - rect.left) / rect.width), 0, this.refs.canvas.width),\r\n      y: clamp(Math.floor(this.refs.canvas.height * (evt.clientY - rect.top) / rect.height), 0, this.refs.canvas.height)\r\n    };\r\n  }\r\n\r\n  dist (a, b) {\r\n    // squared distance - one less operation\r\n    return Math.pow(b.x-a.x, 2) + Math.pow(b.y - a.y, 2);\r\n  }\r\n\r\n  getNearestPoint(evt) {\r\n    const xy = this.convert(evt);\r\n    const cmd = this.props.commands.find(someCmd => someCmd.id === this.props.activeCommand);\r\n    // check dist to points\r\n    let nearest = -1;\r\n    for(let i=0; i < cmd.points.length; i+=2) {\r\n      const pt = {\r\n        x: cmd.points[i],\r\n        y: cmd.points[i+1]\r\n      };\r\n      const dist = this.dist(pt, xy);\r\n      if (dist < 8) {\r\n        nearest = i;\r\n        break;\r\n      }\r\n    }\r\n    return nearest;\r\n  }\r\n\r\n  handleClick(evt) {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    if (!this.props.activeCommand) return;\r\n    if (this.props.drawingMode === 'EDIT_POINTS') return;\r\n    // add point\r\n    const { x, y } = this.convert(evt);\r\n    this.props.addPoint(this.props.activeCommand, x, y);\r\n  }\r\n\r\n  handleMouseDown(evt) {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    if (!this.props.activeCommand || this.props.drawingMode !== 'EDIT_POINTS') return;\r\n    const nearest = this.getNearestPoint(evt);\r\n    if (nearest >= 0) {\r\n      // found a point\r\n      this.setState({\r\n        dragIndex: nearest\r\n      });\r\n    }\r\n  }\r\n\r\n  handleMouseMove(evt) {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    if (this.state.dragIndex < 0) return;\r\n    // move selected point\r\n    const {x, y} = this.convert(evt);\r\n    this.props.movePoint(this.props.activeCommand, this.state.dragIndex, x, y);\r\n  }\r\n\r\n  handleMouseUp(evt) {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    this.setState({\r\n      dragIndex: -1\r\n    });\r\n  }\r\n\r\n  handleContextMenu(evt) {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    return false;\r\n  }\r\n\r\n  render() {\r\n    return [\r\n      <CanvasFrame key=\"frame\" onMouseUp={this.handleMouseUp} onMouseMove={this.handleMouseMove}>\r\n        <PixelCanvas scale={this.state.scale} ref=\"canvas\"\r\n          onMouseDown={this.handleMouseDown}\r\n          onClick={this.handleClick}\r\n          onContextMenu={this.handleContextMenu}\r\n        ></PixelCanvas>\r\n      </CanvasFrame>,\r\n      <ZoomCtrls key=\"ctrls\" dragging={this.state.dragIndex > -1}>\r\n        <button onClick={this.zoomIn}><span role=\"img\" aria-label=\"zoom in\">➕</span></button>\r\n        <button onClick={this.zoomOut}><span role=\"img\" aria-label=\"zoom out\">➖</span></button>\r\n      </ZoomCtrls>\r\n    ];\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    commands: state.commands,\r\n    activeCommand: state.activeCommand,\r\n    drawingMode: state.drawingMode\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, {addPoint, movePoint, removePoint})(Canvas);\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport {setActiveCommand} from '../actions/activeCommand';\r\nimport {moveCommandUp, moveCommandDown, removeCommand, nameCommand} from '../actions/commands';\r\n\r\nimport {hex} from '../utils/colors';\r\n\r\nconst typeToEmoji = {\r\n  'LINE': '✒️',\r\n  'POLYGON': '⭐'\r\n};\r\n\r\nconst ListEntry = styled.div`\r\n  width: 100%;\r\n  border-bottom: 2px outset;\r\n  padding: 10px;\r\n  background-color: ${props => props.active ? 'darkgray' : 'white'}\r\n  display: flex;\r\n  justify-content: flex-end;\r\n`;\r\n\r\nconst EntryCtrls = styled.div`\r\n  display: flex;\r\n  height: 100%;\r\n  width: 3em;\r\n  flex-direction: column;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-right: 5px;\r\n`;\r\n\r\nconst EntryText = styled.div`\r\n  display: flex;\r\n  height: 100%;\r\n  flex-direction: row;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-right: 10px;\r\n  flex: 1;\r\n`;\r\n\r\nconst EntrySwatch = styled.div`\r\n  width: 1em;\r\n  height: 1em;\r\n  display: inline-block;\r\n  background-color: ${props => props.color};\r\n  border: 2px inset;\r\n`;\r\n\r\nconst EntrySwatches = styled.div`\r\n  width: 3em;\r\n  height: 3em;\r\n`;\r\n\r\nclass CommandListItem extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.selectItem = this.selectItem.bind(this);\r\n    this.moveUp = this.moveUp.bind(this);\r\n    this.moveDown = this.moveDown.bind(this);\r\n    this.remove = this.remove.bind(this);\r\n    this.handleNameChange = this.handleNameChange.bind(this);\r\n  }\r\n\r\n  selectItem() {\r\n    if (!(this.props.activeCommand === this.props.item.id)) {\r\n      this.props.setActiveCommand(this.props.item);\r\n    }\r\n    else {\r\n      this.props.setActiveCommand({ id: null });\r\n    }\r\n  }\r\n\r\n  moveUp(evt) {\r\n    evt.stopPropagation();\r\n    this.props.moveCommandUp(this.props.item);\r\n  }\r\n\r\n  moveDown(evt) {\r\n    evt.stopPropagation();\r\n    this.props.moveCommandDown(this.props.item);\r\n  }\r\n\r\n  remove(evt) {\r\n    evt.stopPropagation();\r\n    this.props.removeCommand(this.props.item);\r\n  }\r\n\r\n  handleNameChange(evt) {\r\n    this.props.nameCommand(this.props.item.id, evt.target.value);\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      item,\r\n      activeCommand\r\n    } = this.props;\r\n    return (\r\n      <ListEntry\r\n        onClick={this.selectItem}\r\n        active={activeCommand === item.id}\r\n      >\r\n        <EntryText>\r\n          <span role=\"img\" aria-label={item.type}>{typeToEmoji[item.type]}</span>\r\n          <input type=\"text\" value={item.name} onChange={this.handleNameChange} />\r\n        </EntryText>\r\n        <EntrySwatches>\r\n          <EntrySwatch color={hex[item.colors[0]]}></EntrySwatch>\r\n          <EntrySwatch color={hex[item.colors[1]]}></EntrySwatch>\r\n        </EntrySwatches>\r\n        <EntryCtrls>\r\n          <button onClick={this.moveUp}>\r\n            <span role=\"img\" aria-label=\"move command up\">🔼</span>\r\n          </button>\r\n          <button onClick={this.remove}>\r\n            <span role=\"img\" aria-label=\"remove command\">🗑️</span>\r\n          </button>\r\n          <button onClick={this.moveDown}>\r\n            <span role=\"img\" aria-label=\"move command down\">🔽</span>\r\n          </button>\r\n        </EntryCtrls>\r\n      </ListEntry>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    activeCommand: state.activeCommand\r\n  };\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n  setActiveCommand,\r\n  moveCommandUp,\r\n  moveCommandDown,\r\n  removeCommand,\r\n  nameCommand\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CommandListItem);\r\n","import * as types from './actionTypes';\r\n\r\nexport function setActiveCommand(command) {\r\n  return {\r\n    type: types.SET_ACTIVE_COMMAND,\r\n    payload: command.id\r\n  };\r\n}","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport CommandListItem from './CommandListItem';\r\n\r\nconst StyledList = styled.div`\r\n  border: 2px inset;\r\n  border-top: none;\r\n  width: 300px;\r\n  height: 100%;\r\n  overflow-y: scroll;\r\n  margin: 0 10px 0 0;\r\n  padding-top: 10px;\r\n`;\r\n\r\nclass CommandList extends Component {\r\n  render() {\r\n    const {commands} = this.props;\r\n    return (\r\n      <StyledList>\r\n        {\r\n          commands.map(cmd => (<CommandListItem key={cmd.id} item={cmd} />))\r\n        }\r\n      </StyledList>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    commands: state.commands\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps)(CommandList);\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport {setColor} from '../actions/commands';\r\n\r\nimport {hex} from '../utils/colors';\r\n\r\nconst PaletteWrap = styled.div`\r\n  margin: 10px;\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: center;\r\n`;\r\n\r\nconst Swatch = styled.div`\r\n  width: 20px;\r\n  height: 20px;\r\n  background-color: ${props => props.color};\r\n  border: 2px  ${props => props.active? 'dashed' : 'inset'};\r\n  border-color:  ${props => props.active? 'black' : 'auto'};\r\n`;\r\n\r\nclass ColorPalette extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      activeIndex: -1\r\n    };\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    const activeCmd = nextProps.commands.find(cmd => cmd.id === nextProps.activeCommand);\r\n    if (activeCmd) {\r\n      this.setState({\r\n        activeIndex: activeCmd.colors[nextProps.index]\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {activeCommand, setColor, index} = this.props;\r\n    return (\r\n      <PaletteWrap>\r\n        {\r\n          hex.map((col, colorIndex) =>(\r\n            <Swatch color={col} key={colorIndex} active={this.state.activeIndex === colorIndex}\r\n              onClick={() => {setColor(activeCommand, colorIndex, index)}}>\r\n            </Swatch>\r\n          ))\r\n        }\r\n      </PaletteWrap>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    activeCommand: state.activeCommand,\r\n    commands: state.commands\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, {setColor})(ColorPalette);\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport {setPattern} from '../actions/commands';\r\n\r\nconst Wrap = styled.div`\r\n  width: 100px;\r\n  height: 100px;\r\n`;\r\n\r\nconst Check = styled.input`\r\n  width: 25%;\r\n  height: 25%;\r\n  float: left;\r\n  margin: 0;\r\n`;\r\n\r\nclass PatternToggle extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const activeCmd = props.commands.find(cmd => cmd.id === props.activeCommand);\r\n    if (activeCmd) {\r\n      this.state ={\r\n        values: [...activeCmd.pattern]\r\n      };\r\n    }\r\n    else {\r\n      this.state = {values:[\r\n        false, false, false, false,\r\n        false, false, false, false,\r\n        false, false, false, false,\r\n        false, false, false, false,\r\n      ]};\r\n    }\r\n    this.toggleValue = this.toggleValue.bind(this);\r\n  }\r\n  componentWillReceiveProps(nextProps) {\r\n    const activeCmd = nextProps.commands.find(cmd => cmd.id === nextProps.activeCommand);\r\n    if (activeCmd) {\r\n      this.setState({\r\n        values: [...activeCmd.pattern]\r\n      });\r\n    }\r\n  }\r\n  toggleValue(index) {\r\n    this.props.setPattern(this.props.activeCommand, this.state.values.map((val, valIndex) => {\r\n      if (valIndex === index) {\r\n        return !val;\r\n      }\r\n      return val;\r\n    }))\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Wrap>\r\n        {\r\n          this.state.values.map((value, index) => (\r\n            <Check type=\"checkbox\" key={index} checked={value} onChange={() => {this.toggleValue(index);}} />\r\n          ))\r\n        }\r\n      </Wrap>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    activeCommand: state.activeCommand,\r\n    commands: state.commands\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, {setPattern})(PatternToggle);\r\n","import React, { Component, Fragment } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport {addCommand, addBackground} from '../actions/commands';\r\nimport {setDrawingMode} from '../actions/drawingMode';\r\n\r\nimport ColorPalette from './ColorPalette';\r\nimport PatternToggle from './PatternToggle';\r\nimport { openModal } from '../actions/modal';\r\n\r\nconst ToolsWrap = styled.div`\r\n  margin: 10px;\r\n  flex: 1;\r\n  min-height: 100px;\r\n  z-index: 2;\r\n  display: flex;\r\n  flex-direction: row;\r\n  align-items: flex-start;\r\n  justify-content: space-between;\r\n  overflow-y: scroll;\r\n  padding: 0 10px;\r\n`;\r\n\r\nconst ToolsColumn = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: flex-start;\r\n`;\r\n\r\nconst ToolButton = styled.button`\r\n  margin: 0px 5px 5px 5px;\r\n  border-width: 2px;\r\n  border-color: ${props => props.active ? 'blue' : 'none'};\r\n`;\r\n\r\nconst ToolRow = styled.div`\r\n  min-height: 30px;\r\n`;\r\n\r\nclass ToolsPalette extends Component {\r\n\r\n  render() {\r\n    const {\r\n      addCommand,\r\n      activeCommand,\r\n      setDrawingMode,\r\n      drawingMode,\r\n      addBackground,\r\n      openModal\r\n      } = this.props;\r\n    return (\r\n      <ToolsWrap>\r\n        <ToolsColumn>\r\n          <ToolRow>\r\n          <ToolButton\r\n            onClick={() => {addCommand('LINE')}}>\r\n            <span role=\"img\" aria-label=\"add line\">✒️ Add Line</span>\r\n          </ToolButton>\r\n          <ToolButton\r\n            onClick={() => {addCommand('POLYGON')}}>\r\n            <span role=\"img\" aria-label=\"add polygon\">⭐ Add Polygon</span>\r\n          </ToolButton>\r\n          <ToolButton\r\n            onClick={() => {addBackground()}}>\r\n            <span role=\"img\" aria-label=\"add background\">🖼️ Add Background</span>\r\n          </ToolButton>\r\n          <ToolButton\r\n            onClick={() => {openModal()}} >\r\n            <span role=\"img\" aria-label=\"open export modal\">💾 Import/Export</span>\r\n          </ToolButton>\r\n          </ToolRow>\r\n          <ToolRow>\r\n          {\r\n            activeCommand !== null && (\r\n              <Fragment>\r\n                <ToolButton\r\n                  onClick={() => {setDrawingMode('ADD_POINTS')}} active={drawingMode === 'ADD_POINTS'}>\r\n                  <span role=\"img\" aria-label=\"add points\">➕ Add Points</span>\r\n                </ToolButton>\r\n                <ToolButton\r\n                  onClick={() => {setDrawingMode('EDIT_POINTS')}} active={drawingMode === 'EDIT_POINTS'}>\r\n                  <span role=\"img\" aria-label=\"edit points\">📍 Edit Points</span>\r\n                </ToolButton>\r\n              </Fragment>\r\n            )\r\n          }\r\n          </ToolRow>\r\n        </ToolsColumn>\r\n        <ToolsColumn>\r\n          <ColorPalette index={0}></ColorPalette>\r\n          <ColorPalette index={1}></ColorPalette>\r\n        </ToolsColumn>\r\n        <ToolsColumn>\r\n          <PatternToggle></PatternToggle>\r\n        </ToolsColumn>\r\n      </ToolsWrap>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    activeCommand: state.activeCommand,\r\n    drawingMode: state.drawingMode\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, {addCommand, addBackground, setDrawingMode, openModal})(ToolsPalette);\r\n","import * as types from './actionTypes';\r\n\r\nexport function setDrawingMode(mode) {\r\n  return {\r\n    type: types.SET_DRAWING_MODE,\r\n    payload: mode\r\n  };\r\n}","import * as types from './actionTypes';\r\n\r\nexport function openModal() {\r\n  return {\r\n    type: types.OPEN_MODAL\r\n  };\r\n}\r\n\r\nexport function closeModal() {\r\n  return {\r\n    type: types.CLOSE_MODAL\r\n  };\r\n}","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport {closeModal} from '../actions/modal';\r\nimport {setCommands} from '../actions/commands';\r\n\r\nconst Overlay = styled.div`\r\n  position: absolute;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: rgba(0,0,0,0.5);\r\n  z-index: 5;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n`;\r\n\r\nconst ModalWindow = styled.div`\r\n  background-color: #fff;\r\n  box-shadow: 0px 10px 20px rgba(0,0,0,0.1);\r\n  cursor: auto;\r\n`;\r\n\r\nconst Header = styled.div`\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: space-between;\r\n  padding: 10px;\r\n\r\n  p {\r\n    margin: 0 10px 0 0;\r\n  }\r\n`;\r\n\r\nconst Body = styled.div`\r\n  padding: 10px;\r\n`;\r\n\r\nconst ExitButton = styled.div`\r\n  cursor: pointer;\r\n`;\r\n\r\nclass ExportModal extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.exitModal = this.exitModal.bind(this);\r\n    this.importFile = this.importFile.bind(this);\r\n  }\r\n\r\n  importFile(evt) {\r\n    const reader = new FileReader();\r\n    reader.onload = (loadevt) => {\r\n      const data = JSON.parse(loadevt.target.result);\r\n      this.props.setCommands(data);\r\n      this.props.closeModal();\r\n    };\r\n    reader.readAsText(evt.target.files[0]);\r\n  }\r\n\r\n  calculatePattern(values) {\r\n    let count = 0;\r\n    values.forEach((v, id) => {\r\n      let w = 0;\r\n      if (v && id > 0) {\r\n        w = Math.pow(2,15-id);\r\n      }\r\n      else if (v) {\r\n        w -= 32768;\r\n      }\r\n      count += w;\r\n    });\r\n    return count;\r\n  }\r\n\r\n  compressToPico(cmds) {\r\n    return cmds.map(cmd => {\r\n      let str = '';\r\n      if (cmd.type === 'POLYGON') {\r\n        str += 'poly('\r\n      }\r\n      else if (cmd.type === 'LINE') {\r\n        str += 'line('\r\n      }\r\n      let hexCol = (16 * cmd.colors[1] + cmd.colors[0]);\r\n      const patternData = this.calculatePattern(cmd.pattern);\r\n      str += `'${cmd.points.join(',')}', 0x${hexCol.toString(16)}, ${patternData})\\n`;\r\n      return str;\r\n    });\r\n  }\r\n\r\n  exitModal(evt) {\r\n    evt.stopPropagation();\r\n    this.props.closeModal();\r\n  }\r\n\r\n  render() {\r\n    const {commands, modalOpen} = this.props;\r\n    if (!modalOpen) return null;\r\n\r\n    const jsonBlob = new Blob([JSON.stringify(commands, null, 2)], { type: 'application/json' });\r\n    const picoBlob = new Blob(this.compressToPico(commands), { type: 'text/plain' });\r\n    const jsonUrl = window.URL.createObjectURL(jsonBlob);\r\n    const picoUrl = window.URL.createObjectURL(picoBlob);\r\n\r\n    return (\r\n      <Overlay>\r\n        <ModalWindow>\r\n          <Header>\r\n            <p>\r\n              Import and export data\r\n            </p>\r\n            <ExitButton onClick={this.exitModal}><span role=\"img\" aria-label=\"exit modal button\">❌</span></ExitButton>\r\n          </Header>\r\n          <Body>\r\n            <p>\r\n              Import JSON: <input type=\"file\" onChange={this.importFile} /> \r\n            </p>\r\n            <p>\r\n              <a download=\"gmagic_drawing.json\" href={jsonUrl}>Download JSON</a>\r\n            </p>\r\n            <p>\r\n              <a download=\"gmagic_drawing.txt\" href={picoUrl}>Download PICO-8 code</a>\r\n            </p>\r\n          </Body>\r\n        </ModalWindow>\r\n      </Overlay>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    commands: state.commands,\r\n    modalOpen: state.modalOpen\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, {closeModal, setCommands})(ExportModal);\r\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport styled from 'styled-components';\n\nimport Canvas from './Canvas';\nimport CommandList from './CommandList';\nimport ToolsPalette from './ToolsPalette';\nimport ExportModal from './ExportModal';\n\nconst Row = styled.div`\n  width: 100%;\n  height: 80vh;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: flex-start;\n  margin: 0;\n`;\n\nconst Wrap = styled.div`\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  display: flex;\n  flex-direction: column;\n`;\n\nclass App extends Component {\n  render() {\n    return (\n      <Wrap>\n        <Row>\n          <Canvas></Canvas>\n          <CommandList></CommandList>\n        </Row>\n        <ToolsPalette></ToolsPalette>\n        <ExportModal />\n      </Wrap>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {};\n}\n\nexport default connect(mapStateToProps)(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","export default {\r\n  commands: [\r\n    {\r\n      id: 12345,\r\n      name: 'Background',\r\n      type: 'POLYGON',\r\n      points: [\r\n        0, 0, 127, 0, 127, 127, 0, 127\r\n      ],\r\n      colors: [6,7],\r\n      pattern: [\r\n        true, true, false, false,\r\n        true, true, false, false,\r\n        false, false, true, true,\r\n        false, false, true, true\r\n      ]\r\n    }\r\n  ],\r\n  activeCommand: null,\r\n  drawingMode: 'EDIT_POINTS',\r\n  modalOpen: false\r\n}","import { combineReducers } from 'redux';\r\n\r\nimport commandsReducer from './commands';\r\nimport activeCommandReducer from './activeCommand';\r\nimport drawingModeReducer from './drawingMode'\r\nimport modalReducer from './modal';\r\n\r\nexport default combineReducers({\r\n  commands: commandsReducer,\r\n  activeCommand: activeCommandReducer,\r\n  drawingMode: drawingModeReducer,\r\n  modalOpen: modalReducer\r\n});\r\n","import initialState from '../store/initialState';\r\nimport * as types from '../actions/actionTypes';\r\n\r\nexport default function commandsReducer(state = initialState.commands, action) {\r\n  switch (action.type) {\r\n    \r\n    case types.ADD_COMMAND:\r\n      return [\r\n        ...state,\r\n        {\r\n          id: action.payload.id,\r\n          name: `cmd-${action.payload.id}`,\r\n          type: action.payload.type,\r\n          points: [],\r\n          colors: [0,7],\r\n          pattern: [\r\n            false, false, false, false,\r\n            false, false, false, false,\r\n            false, false, false, false,\r\n            false, false, false, false\r\n          ]\r\n        }\r\n      ];\r\n    \r\n    case types.REMOVE_COMMAND:\r\n      return [\r\n        ...state.filter(comm => comm.id !== action.payload.id)\r\n      ];\r\n\r\n      case types.ADD_BACKGROUND:\r\n      return [\r\n        {\r\n          id: action.payload.id,\r\n          name: `Background-${action.payload.id}`,\r\n          type: action.payload.type,\r\n          points: [0,0, 127,0, 127,127, 0,127],\r\n          colors: [7,0],\r\n          pattern: [\r\n            false, false, false, false,\r\n            false, false, false, false,\r\n            false, false, false, false,\r\n            false, false, false, false\r\n          ]\r\n        },\r\n        ...state\r\n      ];\r\n\r\n    case types.MOVE_COMMAND_UP: {\r\n      let foundCmdIndex = state.findIndex(cmd => cmd.id === action.payload.id);\r\n      if (foundCmdIndex <= 0) {\r\n        // if 0 nowhere to move up\r\n        return [...state];\r\n      }\r\n      let foundCmd = state[foundCmdIndex];\r\n      return [\r\n        ...state.slice(0, foundCmdIndex-1),\r\n        { ...foundCmd },\r\n        {...state[foundCmdIndex-1]},\r\n        ...state.slice(foundCmdIndex+1)\r\n      ];\r\n    }\r\n\r\n    case types.MOVE_COMMAND_DOWN: {\r\n      let foundCmdIndex = state.findIndex(cmd => cmd.id === action.payload.id);\r\n      if (foundCmdIndex <0 || foundCmdIndex === state.length-1) {\r\n        // if not found or furthest down ignore\r\n        return [...state];\r\n      }\r\n      let foundCmd = state[foundCmdIndex];\r\n      return [\r\n        ...state.slice(0, foundCmdIndex),\r\n        {...state[foundCmdIndex+1]},\r\n        { ...foundCmd },\r\n        ...state.slice(foundCmdIndex+2)\r\n      ];\r\n    }\r\n\r\n    case types.MOVE_POINT: {\r\n      const {id, index, x, y} = action.payload;\r\n      return state.map(cmd => {\r\n        if (cmd.id === id) {\r\n          return {\r\n            ...cmd,\r\n            points: cmd.points.map((pt, idx) => {\r\n              if (idx === index) {\r\n                return x;\r\n              }\r\n              else if(idx === index+1) {\r\n                return y;\r\n              }\r\n              return pt;\r\n            })\r\n          }\r\n        }\r\n        return cmd;\r\n      })\r\n    }\r\n\r\n    case types.ADD_POINT: {\r\n      const {id, x, y} = action.payload;\r\n      return state.map(cmd => {\r\n        if (cmd.id === id) {\r\n          return {\r\n            ...cmd,\r\n            points: [\r\n              ...cmd.points,\r\n              x,\r\n              y\r\n            ]\r\n          }\r\n        }\r\n        return cmd;\r\n      });\r\n    }\r\n\r\n    case types.REMOVE_POINT: {\r\n      const {id, index} = action.payload;\r\n      return state.map(cmd => {\r\n        if (cmd.id === id) {\r\n          return {\r\n            ...cmd,\r\n            points: cmd.points.splice(index, 2)\r\n          }\r\n        }\r\n        return cmd;\r\n      });\r\n    }\r\n\r\n    case types.SET_COLOR: {\r\n      const {id, color, index} = action.payload;\r\n      return state.map(cmd => {\r\n        if (cmd.id === id) {\r\n          return {\r\n            ...cmd,\r\n            colors: cmd.colors.map((someCol, someIndex) => {\r\n              if (index === someIndex) {\r\n                return color;\r\n              }\r\n              return someCol;\r\n            })\r\n          }\r\n        }\r\n        return cmd;\r\n      });\r\n    }\r\n\r\n    case types.NAME_COMMAND: {\r\n      const {id, name} = action.payload;\r\n      return state.map(cmd => {\r\n        if (cmd.id === id) {\r\n          return {\r\n            ...cmd,\r\n            name\r\n          }\r\n        }\r\n        return cmd;\r\n      });\r\n    }\r\n\r\n    case types.SET_PATTERN: {\r\n      const {id, pattern} = action.payload;\r\n      return state.map(cmd => {\r\n        if (cmd.id === id) {\r\n          return {\r\n            ...cmd,\r\n            pattern: [...pattern]\r\n          }\r\n        }\r\n        return cmd;\r\n      });\r\n    }\r\n\r\n    case types.SET_COMMANDS: {\r\n      // TODO: some command validation\r\n      return [\r\n        ...action.payload\r\n      ];\r\n    }\r\n    \r\n    default:\r\n      return state;\r\n  }\r\n}","import initialState from '../store/initialState';\r\nimport * as types from '../actions/actionTypes';\r\n\r\nexport default function activeCommandReducer(state = initialState.activeCommand, action) {\r\n  switch (action.type) {\r\n    \r\n    case types.SET_ACTIVE_COMMAND:\r\n      return action.payload;\r\n    \r\n    // when addCommand is called, set that command to active\r\n    case types.ADD_COMMAND:\r\n      return action.payload.id;\r\n    \r\n    case types.REMOVE_COMMAND: {\r\n      return (action.payload.id === state) ? null : state;\r\n    }\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}","import initialState from '../store/initialState';\r\nimport * as types from '../actions/actionTypes';\r\n\r\nexport default function drawingModeReducer(state = initialState.drawingMode, action) {\r\n  switch (action.type) {\r\n    \r\n    case types.SET_DRAWING_MODE:\r\n      return action.payload;\r\n\r\n    case types.SET_ACTIVE_COMMAND:\r\n      return 'EDIT_POINTS';\r\n    \r\n    case types.ADD_COMMAND:\r\n      return 'ADD_POINTS';\r\n    \r\n    default:\r\n      return state;\r\n  }\r\n}","import initialState from '../store/initialState';\r\nimport * as types from '../actions/actionTypes';\r\n\r\nexport default function modalReducer(state = initialState.modalOpen, action) {\r\n  switch (action.type) {\r\n    \r\n    case types.OPEN_MODAL:\r\n      return true;\r\n\r\n    case types.CLOSE_MODAL:\r\n      return false;\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}","import { createStore } from 'redux';\r\nimport rootReducer from '../reducers/index';\r\nimport initialState from './initialState';\r\n\r\nexport default createStore(\r\n  rootReducer,\r\n  initialState,\r\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\r\n);","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\nimport * as serviceWorker from './serviceWorker';\nimport { Provider } from 'react-redux';\nimport store from './store';\n\nconst rootElement = document.getElementById('root');\n\nReactDOM.render((\n  <Provider store={store}>\n    <App />\n  </Provider>\n  ), rootElement);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}