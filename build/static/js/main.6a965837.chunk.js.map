{"version":3,"sources":["utils/colors.js","actions/actionTypes.js","actions/commands.js","components/Canvas.js","components/CommandListItem.js","actions/activeCommand.js","components/CommandList.js","components/ColorPalette.js","components/PatternToggle.js","components/ToolsPalette.js","actions/drawingMode.js","actions/modal.js","components/ExportModal.js","components/App.js","serviceWorker.js","store/initialState.js","reducers/index.js","reducers/commands.js","reducers/activeCommand.js","reducers/drawingMode.js","reducers/modal.js","store/index.js","index.js"],"names":["hex","ADD_COMMAND","REMOVE_COMMAND","MOVE_COMMAND_UP","MOVE_COMMAND_DOWN","MOVE_POINT","ADD_POINT","REMOVE_POINT","SET_COLOR","NAME_COMMAND","SET_PATTERN","ADD_BACKGROUND","SET_COMMANDS","MOVE_COMMAND","SET_ACTIVE_COMMAND","SET_DRAWING_MODE","OPEN_MODAL","CLOSE_MODAL","commandCount","CanvasFrame","styled","div","_templateObject","ZoomCtrls","_templateObject2","props","dragging","PixelCanvas","canvas","_templateObject3","scale","clamp","val","min","max","Math","Canvas","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","renderCanvas","bind","assertThisInitialized","handleMouseDown","handleMouseMove","handleMouseUp","handleClick","handleContextMenu","zoomIn","zoomOut","state","dragIndex","movingPoints","lastX","lastY","refs","width","height","ctx","getContext","nextProps","setState","x","y","colors","pattern","pf","fillStyle","fillRect","x0","y0","x1","y1","e2","dx","abs","dy","sx","sy","err","loopCt","console","error","concat","fillPattern","pts","polyCorners","length","polyX","polyY","h","push","bresenham","nodeX","nodes","j","i","round","k","swap","l","_this2","clearRect","activeCmd","commands","activeCommand","toConsumableArray","forEach","cmd","type","polygon","points","id","globalCompositeOperation","strokeStyle","strokeRect","evt","rect","getBoundingClientRect","floor","clientX","left","clientY","top","a","b","pow","_this3","xy","convert","find","someCmd","nearest","pt","dist","stopPropagation","preventDefault","drawingMode","_this$convert","addPoint","_this$convert2","getNearestPoint","_this$convert3","movePoint","_this$convert4","moveCommand","_this$convert5","react_default","createElement","key","onMouseUp","onMouseMove","ref","onMouseDown","onClick","onContextMenu","role","aria-label","Component","connect","types","payload","index","removePoint","typeToEmoji","LINE","POLYGON","ListEntry","CommandListItem_templateObject","active","EntryCtrls","CommandListItem_templateObject2","EntryText","CommandListItem_templateObject3","EntrySwatch","_templateObject4","color","EntrySwatches","_templateObject5","CommandListItem","selectItem","moveUp","moveDown","remove","handleNameChange","item","setActiveCommand","moveCommandUp","moveCommandDown","removeCommand","nameCommand","target","value","_this$props","name","onChange","mapDispatchToProps","command","StyledList","CommandList_templateObject","CommandList","map","components_CommandListItem","PaletteWrap","ColorPalette_templateObject","Swatch","ColorPalette_templateObject2","ColorPalette","activeIndex","setColor","col","colorIndex","Wrap","PatternToggle_templateObject","Check","input","PatternToggle_templateObject2","PatternToggle","values","toggleValue","setPattern","valIndex","checked","ToolsWrap","ToolsPalette_templateObject","ToolsColumn","ToolsPalette_templateObject2","ToolButton","button","ToolsPalette_templateObject3","ToolRow","ToolsPalette_templateObject4","ToolsPalette","addCommand","setDrawingMode","addBackground","openModal","href","rel","react","components_ColorPalette","components_PatternToggle","mode","Overlay","ExportModal_templateObject","ModalWindow","ExportModal_templateObject2","Header","ExportModal_templateObject3","Body","ExportModal_templateObject4","ExitButton","ExportModal_templateObject5","ExportModal","exitModal","importFile","reader","FileReader","onload","loadevt","data","JSON","parse","result","setCommands","closeModal","readAsText","files","count","v","w","cmds","str","hexCol","patternData","calculatePattern","join","toString","modalOpen","jsonBlob","Blob","stringify","picoBlob","compressToPico","jsonUrl","window","URL","createObjectURL","picoUrl","download","Row","App_templateObject","App_templateObject2","App","App_Wrap","components_Canvas","components_CommandList","components_ToolsPalette","components_ExportModal","Boolean","location","hostname","match","initialState","combineReducers","arguments","undefined","action","filter","comm","foundCmdIndex","findIndex","foundCmd","slice","objectSpread","_action$payload","idx","_action$payload2","_action$payload3","splice","_action$payload4","someCol","someIndex","_action$payload5","_action$payload6","_action$payload7","createStore","rootReducer","__REDUX_DEVTOOLS_EXTENSION__","rootElement","document","getElementById","ReactDOM","render","es","store","components_App","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.6a965837.chunk.js","sourcesContent":["// PICO-8 Colors\r\n\r\nexport const hex = [\r\n  '#000000', // black\r\n  '#1D2B53', // dark blue\r\n  '#7E2553', // purple\r\n  '#008751', // dark green\r\n  '#AB5236', // brown\r\n  '#5F574F', // dark gray\r\n  '#C2C3C7', // light gray\r\n  '#FFF1E8', // white\r\n  '#FF004D', // red\r\n  '#FFA300', // orange\r\n  '#FFEC27', // yellow\r\n  '#00E436', // green\r\n  '#29ADFF', // blue\r\n  '#83769C', // indigo\r\n  '#FF77A8', // pink\r\n  '#FFCCAA'  // peach\r\n];\r\n\r\nexport const rgb = [\r\n  [0, 0, 0],\r\n  [29, 43, 83],\r\n  [126, 37, 83],\r\n  [0, 135, 81],\r\n  [171, 82, 54],\r\n  [95, 87, 79],\r\n  [194, 195, 199],\r\n  [255, 241, 232],\r\n  [255, 0, 77],\r\n  [255, 163, 0],\r\n  [255, 236, 39],\r\n  [0, 228, 54],\r\n  [41, 173, 255],\r\n  [131, 118, 156],\r\n  [255, 119, 168],\r\n  [255, 204, 170]\r\n];","export const ADD_COMMAND = 'ADD_COMMAND';\r\nexport const REMOVE_COMMAND = 'REMOVE_COMMAND';\r\nexport const MOVE_COMMAND_UP = 'MOVE_COMMAND_UP';\r\nexport const MOVE_COMMAND_DOWN = 'MOVE_COMMAND_DOWN';\r\nexport const MOVE_POINT = 'MOVE_POINT';\r\nexport const ADD_POINT = 'ADD_POINT';\r\nexport const REMOVE_POINT = 'REMOVE_POINT';\r\nexport const SET_COLOR = 'SET_COLOR';\r\nexport const NAME_COMMAND = 'NAME_COMMAND';\r\nexport const SET_PATTERN = 'SET_PATTERN';\r\nexport const ADD_BACKGROUND = 'ADD_BACKGROUND';\r\nexport const SET_COMMANDS = 'SET_COMMANDS';\r\nexport const MOVE_COMMAND = 'MOVE_COMMAND';\r\n\r\nexport const SET_ACTIVE_COMMAND = 'SET_ACTIVE_COMMAND';\r\n\r\nexport const SET_DRAWING_MODE = 'SET_DRAWING_MODE';\r\n\r\nexport const OPEN_MODAL = 'OPEN_MODAL';\r\nexport const CLOSE_MODAL = 'CLOSE_MODAL';","import * as types from './actionTypes';\r\n\r\nlet commandCount = 0;\r\n\r\nexport function addCommand(type) {\r\n  return {\r\n    type: types.ADD_COMMAND,\r\n    payload: {\r\n      type,\r\n      id: ++commandCount\r\n    }\r\n  };\r\n}\r\n\r\nexport function removeCommand(command) {\r\n  return {\r\n    type: types.REMOVE_COMMAND,\r\n    payload: command\r\n  }\r\n}\r\n\r\nexport function moveCommandUp(command) {\r\n  return {\r\n    type: types.MOVE_COMMAND_UP,\r\n    payload: command\r\n  }\r\n}\r\n\r\nexport function moveCommandDown(command) {\r\n  return {\r\n    type: types.MOVE_COMMAND_DOWN,\r\n    payload: command\r\n  }\r\n}\r\n\r\nexport function movePoint(id, index, x, y) {\r\n  return {\r\n    type: types.MOVE_POINT,\r\n    payload: { id, index, x, y }\r\n  };\r\n}\r\n\r\nexport function addPoint(id, x, y) {\r\n  return {\r\n    type: types.ADD_POINT,\r\n    payload: { id, x, y }\r\n  };\r\n}\r\n\r\nexport function removePoint(id, index) {\r\n  return {\r\n    type: types.REMOVE_POINT,\r\n    payload: { id, index }\r\n  };\r\n}\r\n\r\nexport function setColor(id, color, index) {\r\n  return {\r\n    type: types.SET_COLOR,\r\n    payload: { id, color, index }\r\n  };\r\n}\r\n\r\nexport function nameCommand(id, name) {\r\n  return {\r\n    type: types.NAME_COMMAND,\r\n    payload: {id, name}\r\n  }\r\n}\r\n\r\nexport function setPattern(id, pattern) {\r\n  return {\r\n    type: types.SET_PATTERN,\r\n    payload: {id, pattern}\r\n  }\r\n}\r\n\r\nexport function addBackground() {\r\n  return {\r\n    type: types.ADD_BACKGROUND,\r\n    payload: {\r\n      type: 'POLYGON',\r\n      id: ++commandCount\r\n    }\r\n  }\r\n}\r\n\r\nexport function setCommands(commands) {\r\n  return {\r\n    type: types.SET_COMMANDS,\r\n    payload: commands\r\n  }\r\n}\r\n\r\nexport function moveCommand(id, x, y) {\r\n  return {\r\n    type: types.MOVE_COMMAND,\r\n    payload: { id, x, y }\r\n  }\r\n}","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport {hex} from '../utils/colors';\r\n\r\nimport {addPoint, movePoint, removePoint, moveCommand} from '../actions/commands';\r\n\r\nconst CanvasFrame = styled.div`\r\n  position: relative;\r\n  flex: 1;\r\n  height: 100%;\r\n  overflow: scroll;\r\n  display: flex;\r\n  justify-content: flex-start;\r\n  align-items: flex-start;\r\n  background-color: darkgray;\r\n  margin-right: 10px;\r\n`;\r\n\r\nconst ZoomCtrls = styled.div`\r\n  position: absolute;\r\n  display: ${props => props.dragging ? 'none' : 'block' };\r\n  z-index: 3;\r\n  left: 10px;\r\n  top: 10px;\r\n`;\r\n\r\nconst PixelCanvas = styled.canvas`\r\n  width: ${props => props.scale}px;\r\n  height: ${props => props.scale}px;\r\n  image-rendering: optimizeSpeed;\r\n  image-rendering: -moz-crisp-edges;\r\n  image-rendering: -webkit-optimize-contrast;\r\n  image-rendering: optimize-contrast;\r\n  image-rendering: pixelated;\r\n  -ms-interpolation-mode: nearest-neighbor;\r\n  z-index: 1;\r\n  background-color: white;\r\n  flex-shrink: 0;\r\n  margin: 50px;\r\n  box-shadow: 0px 10px 20px rgba(0,0,0,0.2);\r\n`;\r\n\r\nfunction clamp(val, min, max) {\r\n  return Math.max(Math.min(max, val), min);\r\n}\r\n\r\nclass Canvas extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.renderCanvas = this.renderCanvas.bind(this);\r\n    this.handleMouseDown = this.handleMouseDown.bind(this);\r\n    this.handleMouseMove = this.handleMouseMove.bind(this);\r\n    this.handleMouseUp = this.handleMouseUp.bind(this);\r\n    this.handleClick = this.handleClick.bind(this);\r\n    this.handleContextMenu = this.handleContextMenu.bind(this);\r\n    this.zoomIn = this.zoomIn.bind(this);\r\n    this.zoomOut = this.zoomOut.bind(this);\r\n\r\n    this.state = {\r\n      dragIndex: -1,\r\n      movingPoints: false,\r\n      scale: 512,\r\n      lastX: 0,\r\n      lastY: 0\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.refs.canvas.width = 128;\r\n    this.refs.canvas.height = 128;\r\n    this.ctx = this.refs.canvas.getContext('2d');\r\n    this.renderCanvas(this.props);\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    this.renderCanvas(nextProps);\r\n  }\r\n\r\n  zoomIn() {\r\n    this.setState({\r\n      scale: this.state.scale * 2\r\n    });\r\n  }\r\n\r\n  zoomOut() {\r\n    this.setState({\r\n      scale: this.state.scale / 2\r\n    });\r\n  }\r\n\r\n  fillPattern(x, y, colors, pattern) {\r\n    const px = x % 4;\r\n    const py = y % 4;\r\n    const pc = py * 4 + px;\r\n    const pf = pattern[pc];\r\n    this.ctx.fillStyle = hex[colors[pf ? 1 : 0]];\r\n    this.ctx.fillRect(x, y,1,1);\r\n  }\r\n\r\n  // based on http://members.chello.at/~easyfilter/bresenham.html\r\n  bresenham(x0, y0, x1, y1, colors, pattern) {\r\n    const dx = Math.abs(x1 - x0);\r\n    const dy = -Math.abs(y1 - y0);\r\n    const sx = (x0 < x1) ? 1 : -1;\r\n    const sy = (y0 < y1) ? 1 : -1;\r\n    let x = x0, y = y0;\r\n    let err = dx + dy;\r\n    let e2;\r\n    let loopCt = 0;\r\n    do {\r\n      loopCt++;\r\n      if (loopCt > 500) {\r\n        console.error(`error drawing line ${x0}, ${y0} to ${x1}, ${y1}`);\r\n        break;\r\n      }\r\n      this.fillPattern(x,y, colors, pattern);\r\n      if ((x===x1) && (y===y1)) break;\r\n      e2 = 2 * err;\r\n      if (e2 >= dy) {\r\n        err += dy;\r\n        x += sx;\r\n      }\r\n      if (e2 <= dx) {\r\n        err += dx;\r\n        y += sy;\r\n      }\r\n    } while (true);\r\n  }\r\n\r\n  polygon(pts, colors, pattern) {\r\n    // http://alienryderflex.com/polygon_fill/\r\n    const polyCorners = pts.length / 2;\r\n    const polyX = [];\r\n    const polyY = [];\r\n    // sort out XY arrays\r\n    for (let h=0; h<pts.length; h+=2) {\r\n      polyX.push(pts[h]);\r\n      polyY.push(pts[h+1]);\r\n      if (h < pts.length-3) {\r\n        // fudge for scanline not working when y1 = y2\r\n        this.bresenham(pts[h], pts[h+1], pts[h+2], pts[h+3], colors, pattern);\r\n      }\r\n    }\r\n    //build node list\r\n    for (let y=0; y<this.refs.canvas.height; y++) {\r\n      const nodeX = [];\r\n      let nodes = 0;\r\n      let j = polyCorners - 1;\r\n      for (let i=0; i<polyCorners; i++) {\r\n        if (\r\n          ((polyY[i] < y) && (polyY[j] >= y)) ||\r\n          ((polyY[j] < y) && (polyY[i] >= y))\r\n        ) {\r\n          nodeX[nodes++] = (\r\n            polyX[i] +\r\n            Math.round((y-polyY[i])/(polyY[j]-polyY[i] + 0.0001) * // fudge for 0/0\r\n            (polyX[j] - polyX[i]))\r\n          );\r\n        }\r\n        j = i;\r\n      }\r\n      // sort nodes\r\n      let k=0;\r\n      while(k < nodes-1) {\r\n        if (nodeX[k] > nodeX[k+1]) {\r\n          let swap = nodeX[k];\r\n          nodeX[k] = nodeX[k+1];\r\n          nodeX[k+1] = swap;\r\n          if (k) k--;\r\n        }\r\n        else {\r\n          k++;\r\n        }\r\n      }\r\n      // fill the pixels between pairs\r\n      for (let l=0; l<nodes; l+=2) {\r\n        if (nodeX[l] >= this.refs.canvas.width) break;\r\n        if (nodeX[l+1] > 0) {\r\n          if (nodeX[l] < 0) nodeX[l] = 0;\r\n          if (nodeX[l+1] > this.refs.canvas.width) nodeX[l+1] = this.refs.canvas.width-1;\r\n          this.bresenham(nodeX[l], y, nodeX[l+1], y, colors, pattern);\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  renderCanvas(props) {\r\n    this.ctx.clearRect(0, 0, this.refs.canvas.width, this.refs.canvas.height);\r\n    const {commands, activeCommand} = props;\r\n    const cmds = [...commands];//.reverse();\r\n    let activeCmd;\r\n    cmds.forEach(cmd => {\r\n      switch(cmd.type) {\r\n        case 'POLYGON': {\r\n          this.polygon(cmd.points, cmd.colors, cmd.pattern);\r\n          break;\r\n        }\r\n        case 'LINE': {\r\n          for (let i = 0; i < cmd.points.length-3; i+=2) {\r\n            const x0 = cmd.points[i];\r\n            const y0 = cmd.points[i+1];\r\n            const x1 = cmd.points[i+2];\r\n            const y1 = cmd.points[i+3];\r\n            this.bresenham(x0, y0, x1, y1, cmd.colors, cmd.pattern);\r\n          }\r\n          break;\r\n        }\r\n        default:\r\n          return;\r\n      }\r\n      if(cmd.id === activeCommand) {\r\n        activeCmd = cmd;\r\n      }\r\n    });\r\n    if(activeCmd) {\r\n      // draw points\r\n      this.ctx.globalCompositeOperation = 'xor';\r\n      this.ctx.strokeStyle = hex[activeCmd.colors[0]];\r\n      for (let i=0; i< activeCmd.points.length; i+=2) {\r\n        const x = activeCmd.points[i] - 0.5;\r\n        const y = activeCmd.points[i+1] - 0.5;\r\n        this.ctx.strokeRect(x, y, 2, 2);\r\n      }\r\n      this.ctx.globalCompositeOperation = 'source-over';\r\n    }\r\n  }\r\n\r\n  convert(evt) {\r\n    const rect = this.refs.canvas.getBoundingClientRect();\r\n    return {\r\n      x: clamp(Math.floor(this.refs.canvas.width * (evt.clientX - rect.left) / rect.width), 0, this.refs.canvas.width),\r\n      y: clamp(Math.floor(this.refs.canvas.height * (evt.clientY - rect.top) / rect.height), 0, this.refs.canvas.height)\r\n    };\r\n  }\r\n\r\n  dist (a, b) {\r\n    // squared distance - one less operation\r\n    return Math.pow(b.x-a.x, 2) + Math.pow(b.y - a.y, 2);\r\n  }\r\n\r\n  getNearestPoint(evt) {\r\n    const xy = this.convert(evt);\r\n    const cmd = this.props.commands.find(someCmd => someCmd.id === this.props.activeCommand);\r\n    // check dist to points\r\n    let nearest = -1;\r\n    for(let i=0; i < cmd.points.length; i+=2) {\r\n      const pt = {\r\n        x: cmd.points[i],\r\n        y: cmd.points[i+1]\r\n      };\r\n      const dist = this.dist(pt, xy);\r\n      if (dist < 8) {\r\n        nearest = i;\r\n        break;\r\n      }\r\n    }\r\n    return nearest;\r\n  }\r\n\r\n  handleClick(evt) {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    if (this.props.activeCommand === null) return;\r\n    if (this.props.drawingMode !== 'ADD_POINTS') return;\r\n    // add point\r\n    const { x, y } = this.convert(evt);\r\n    this.props.addPoint(this.props.activeCommand, x, y);\r\n  }\r\n\r\n  handleMouseDown(evt) {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    if (this.props.activeCommand === null) return;\r\n    if (this.props.drawingMode === 'MOVE_POINTS') {\r\n      const {x, y} = this.convert(evt);\r\n      this.setState({\r\n        movingPoints: true,\r\n        lastX: x,\r\n        lastY: y\r\n      });\r\n    }\r\n    else if (this.props.drawingMode === 'EDIT_POINTS') {\r\n      const nearest = this.getNearestPoint(evt);\r\n      if (nearest >= 0) {\r\n        // found a point\r\n        this.setState({\r\n          dragIndex: nearest\r\n        });\r\n      }\r\n    }\r\n  }\r\n\r\n  handleMouseMove(evt) {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    if (this.props.activeCommand === null) return;\r\n    if (this.props.drawingMode === 'EDIT_POINTS' && this.state.dragIndex >= 0) {\r\n      // move selected point\r\n      const {x, y} = this.convert(evt);\r\n      this.props.movePoint(this.props.activeCommand, this.state.dragIndex, x, y);\r\n    }\r\n    else if (this.props.drawingMode === 'MOVE_POINTS' && this.state.movingPoints) {\r\n      const {x, y} = this.convert(evt);\r\n      const dx = x - this.state.lastX;\r\n      const dy = y - this.state.lastY;\r\n      this.props.moveCommand(this.props.activeCommand, dx, dy);\r\n      this.setState({\r\n        lastX: x,\r\n        lastY: y\r\n      });\r\n    }\r\n  }\r\n\r\n  handleMouseUp(evt) {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    const {x, y} = this.convert(evt);\r\n    this.setState({\r\n      dragIndex: -1,\r\n      movingPoints: false,\r\n      lastX: x,\r\n      lastY: y\r\n    });\r\n  }\r\n\r\n  handleContextMenu(evt) {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    return false;\r\n  }\r\n\r\n  render() {\r\n    return [\r\n      <CanvasFrame key=\"frame\" onMouseUp={this.handleMouseUp} onMouseMove={this.handleMouseMove}>\r\n        <PixelCanvas scale={this.state.scale} ref=\"canvas\"\r\n          onMouseDown={this.handleMouseDown}\r\n          onClick={this.handleClick}\r\n          onContextMenu={this.handleContextMenu}\r\n        ></PixelCanvas>\r\n      </CanvasFrame>,\r\n      <ZoomCtrls key=\"ctrls\" dragging={this.state.dragIndex > -1}>\r\n        <button onClick={this.zoomIn}><span role=\"img\" aria-label=\"zoom in\">➕</span></button>\r\n        <button onClick={this.zoomOut}><span role=\"img\" aria-label=\"zoom out\">➖</span></button>\r\n      </ZoomCtrls>\r\n    ];\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    commands: state.commands,\r\n    activeCommand: state.activeCommand,\r\n    drawingMode: state.drawingMode\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, {addPoint, movePoint, removePoint, moveCommand})(Canvas);\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport {setActiveCommand} from '../actions/activeCommand';\r\nimport {moveCommandUp, moveCommandDown, removeCommand, nameCommand} from '../actions/commands';\r\n\r\nimport {hex} from '../utils/colors';\r\n\r\nconst typeToEmoji = {\r\n  'LINE': '✒️',\r\n  'POLYGON': '⭐'\r\n};\r\n\r\nconst ListEntry = styled.div`\r\n  width: 100%;\r\n  border-bottom: 2px outset;\r\n  padding: 10px;\r\n  background-color: ${props => props.active ? 'darkgray' : 'white'}\r\n  display: flex;\r\n  justify-content: flex-end;\r\n`;\r\n\r\nconst EntryCtrls = styled.div`\r\n  display: flex;\r\n  height: 100%;\r\n  width: 3em;\r\n  flex-direction: column;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-right: 5px;\r\n`;\r\n\r\nconst EntryText = styled.div`\r\n  display: flex;\r\n  height: 100%;\r\n  flex-direction: row;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-right: 10px;\r\n  flex: 1;\r\n`;\r\n\r\nconst EntrySwatch = styled.div`\r\n  width: 1em;\r\n  height: 1em;\r\n  display: inline-block;\r\n  background-color: ${props => props.color};\r\n  border: 2px inset;\r\n`;\r\n\r\nconst EntrySwatches = styled.div`\r\n  width: 3em;\r\n  height: 3em;\r\n`;\r\n\r\nclass CommandListItem extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.selectItem = this.selectItem.bind(this);\r\n    this.moveUp = this.moveUp.bind(this);\r\n    this.moveDown = this.moveDown.bind(this);\r\n    this.remove = this.remove.bind(this);\r\n    this.handleNameChange = this.handleNameChange.bind(this);\r\n  }\r\n\r\n  selectItem() {\r\n    if (!(this.props.activeCommand === this.props.item.id)) {\r\n      this.props.setActiveCommand(this.props.item);\r\n    }\r\n    else {\r\n      this.props.setActiveCommand({ id: null });\r\n    }\r\n  }\r\n\r\n  moveUp(evt) {\r\n    evt.stopPropagation();\r\n    this.props.moveCommandUp(this.props.item);\r\n  }\r\n\r\n  moveDown(evt) {\r\n    evt.stopPropagation();\r\n    this.props.moveCommandDown(this.props.item);\r\n  }\r\n\r\n  remove(evt) {\r\n    evt.stopPropagation();\r\n    this.props.removeCommand(this.props.item);\r\n  }\r\n\r\n  handleNameChange(evt) {\r\n    this.props.nameCommand(this.props.item.id, evt.target.value);\r\n  }\r\n\r\n  render() {\r\n    const {\r\n      item,\r\n      activeCommand\r\n    } = this.props;\r\n    return (\r\n      <ListEntry\r\n        onClick={this.selectItem}\r\n        active={activeCommand === item.id}\r\n      >\r\n        <EntryText>\r\n          <span role=\"img\" aria-label={item.type}>{typeToEmoji[item.type]}</span>\r\n          <input type=\"text\" value={item.name} onChange={this.handleNameChange} />\r\n        </EntryText>\r\n        <EntrySwatches>\r\n          <EntrySwatch color={hex[item.colors[0]]}></EntrySwatch>\r\n          <EntrySwatch color={hex[item.colors[1]]}></EntrySwatch>\r\n        </EntrySwatches>\r\n        <EntryCtrls>\r\n          <button onClick={this.moveUp}>\r\n            <span role=\"img\" aria-label=\"move command up\">🔼</span>\r\n          </button>\r\n          <button onClick={this.remove}>\r\n            <span role=\"img\" aria-label=\"remove command\">🗑️</span>\r\n          </button>\r\n          <button onClick={this.moveDown}>\r\n            <span role=\"img\" aria-label=\"move command down\">🔽</span>\r\n          </button>\r\n        </EntryCtrls>\r\n      </ListEntry>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    activeCommand: state.activeCommand\r\n  };\r\n}\r\n\r\nconst mapDispatchToProps = {\r\n  setActiveCommand,\r\n  moveCommandUp,\r\n  moveCommandDown,\r\n  removeCommand,\r\n  nameCommand\r\n};\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(CommandListItem);\r\n","import * as types from './actionTypes';\r\n\r\nexport function setActiveCommand(command) {\r\n  return {\r\n    type: types.SET_ACTIVE_COMMAND,\r\n    payload: command.id\r\n  };\r\n}","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport CommandListItem from './CommandListItem';\r\n\r\nconst StyledList = styled.div`\r\n  border: 2px inset;\r\n  border-top: none;\r\n  width: 300px;\r\n  height: 100%;\r\n  overflow-y: scroll;\r\n  margin: 0 10px 0 0;\r\n  padding-top: 10px;\r\n`;\r\n\r\nclass CommandList extends Component {\r\n  render() {\r\n    const {commands} = this.props;\r\n    return (\r\n      <StyledList>\r\n        {\r\n          commands.map(cmd => (<CommandListItem key={cmd.id} item={cmd} />))\r\n        }\r\n      </StyledList>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    commands: state.commands\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps)(CommandList);\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport {setColor} from '../actions/commands';\r\n\r\nimport {hex} from '../utils/colors';\r\n\r\nconst PaletteWrap = styled.div`\r\n  margin: 10px;\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: center;\r\n`;\r\n\r\nconst Swatch = styled.div`\r\n  width: 20px;\r\n  height: 20px;\r\n  background-color: ${props => props.color};\r\n  border: 2px  ${props => props.active? 'dashed' : 'inset'};\r\n  border-color:  ${props => props.active? 'black' : 'auto'};\r\n`;\r\n\r\nclass ColorPalette extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      activeIndex: -1\r\n    };\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    const activeCmd = nextProps.commands.find(cmd => cmd.id === nextProps.activeCommand);\r\n    if (activeCmd) {\r\n      this.setState({\r\n        activeIndex: activeCmd.colors[nextProps.index]\r\n      });\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const {activeCommand, setColor, index} = this.props;\r\n    return (\r\n      <PaletteWrap>\r\n        {\r\n          hex.map((col, colorIndex) =>(\r\n            <Swatch color={col} key={colorIndex} active={this.state.activeIndex === colorIndex}\r\n              onClick={() => {setColor(activeCommand, colorIndex, index)}}>\r\n            </Swatch>\r\n          ))\r\n        }\r\n      </PaletteWrap>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    activeCommand: state.activeCommand,\r\n    commands: state.commands\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, {setColor})(ColorPalette);\r\n","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport {setPattern} from '../actions/commands';\r\n\r\nconst Wrap = styled.div`\r\n  width: 100px;\r\n  height: 100px;\r\n`;\r\n\r\nconst Check = styled.input`\r\n  width: 25%;\r\n  height: 25%;\r\n  float: left;\r\n  margin: 0;\r\n`;\r\n\r\nclass PatternToggle extends Component {\r\n  constructor(props){\r\n    super(props);\r\n\r\n    const activeCmd = props.commands.find(cmd => cmd.id === props.activeCommand);\r\n    if (activeCmd) {\r\n      this.state ={\r\n        values: [...activeCmd.pattern]\r\n      };\r\n    }\r\n    else {\r\n      this.state = {values:[\r\n        false, false, false, false,\r\n        false, false, false, false,\r\n        false, false, false, false,\r\n        false, false, false, false,\r\n      ]};\r\n    }\r\n    this.toggleValue = this.toggleValue.bind(this);\r\n  }\r\n  componentWillReceiveProps(nextProps) {\r\n    const activeCmd = nextProps.commands.find(cmd => cmd.id === nextProps.activeCommand);\r\n    if (activeCmd) {\r\n      this.setState({\r\n        values: [...activeCmd.pattern]\r\n      });\r\n    }\r\n  }\r\n  toggleValue(index) {\r\n    this.props.setPattern(this.props.activeCommand, this.state.values.map((val, valIndex) => {\r\n      if (valIndex === index) {\r\n        return !val;\r\n      }\r\n      return val;\r\n    }))\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Wrap>\r\n        {\r\n          this.state.values.map((value, index) => (\r\n            <Check type=\"checkbox\" key={index} checked={value} onChange={() => {this.toggleValue(index);}} />\r\n          ))\r\n        }\r\n      </Wrap>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    activeCommand: state.activeCommand,\r\n    commands: state.commands\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, {setPattern})(PatternToggle);\r\n","import React, { Component, Fragment } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport {addCommand, addBackground} from '../actions/commands';\r\nimport {setDrawingMode} from '../actions/drawingMode';\r\n\r\nimport ColorPalette from './ColorPalette';\r\nimport PatternToggle from './PatternToggle';\r\nimport { openModal } from '../actions/modal';\r\n\r\nconst ToolsWrap = styled.div`\r\n  margin: 10px;\r\n  flex: 1;\r\n  min-height: 100px;\r\n  z-index: 2;\r\n  display: flex;\r\n  flex-direction: row;\r\n  align-items: flex-start;\r\n  justify-content: space-between;\r\n  overflow-y: scroll;\r\n  padding: 0 10px;\r\n`;\r\n\r\nconst ToolsColumn = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: flex-start;\r\n`;\r\n\r\nconst ToolButton = styled.button`\r\n  margin: 0px 5px 5px 5px;\r\n  border-width: 2px;\r\n  border-color: ${props => props.active ? 'blue' : 'none'};\r\n  cursor: pointer;\r\n`;\r\n\r\nconst ToolRow = styled.div`\r\n  min-height: 30px;\r\n`;\r\n\r\nclass ToolsPalette extends Component {\r\n\r\n  render() {\r\n    const {\r\n      addCommand,\r\n      activeCommand,\r\n      setDrawingMode,\r\n      drawingMode,\r\n      addBackground,\r\n      openModal\r\n      } = this.props;\r\n    return (\r\n      <ToolsWrap>\r\n        <ToolsColumn>\r\n          <ToolRow>\r\n          <ToolButton\r\n            onClick={() => {addCommand('LINE')}}>\r\n            <span role=\"img\" aria-label=\"add line\">✒️ Add Line</span>\r\n          </ToolButton>\r\n          <ToolButton\r\n            onClick={() => {addCommand('POLYGON')}}>\r\n            <span role=\"img\" aria-label=\"add polygon\">⭐ Add Polygon</span>\r\n          </ToolButton>\r\n          <ToolButton\r\n            onClick={() => {addBackground()}}>\r\n            <span role=\"img\" aria-label=\"add background\">🖼️ Add Background</span>\r\n          </ToolButton>\r\n          <ToolButton\r\n            onClick={() => {openModal()}} >\r\n            <span role=\"img\" aria-label=\"open export modal\">💾 Import/Export</span>\r\n          </ToolButton>\r\n          <a href=\"//github.com/hypothete/gmagic\" target=\"_blank\" rel=\"noreferrer noopener\">\r\n            <ToolButton>\r\n              <span role=\"img\" aria-label=\"go to help readme\">❓ Help</span>\r\n            </ToolButton>\r\n          </a>\r\n          </ToolRow>\r\n          <ToolRow>\r\n          {\r\n            activeCommand !== null && (\r\n              <Fragment>\r\n                <ToolButton\r\n                  onClick={() => {setDrawingMode('ADD_POINTS')}} active={drawingMode === 'ADD_POINTS'}>\r\n                  <span role=\"img\" aria-label=\"add points\">➕ Add Points</span>\r\n                </ToolButton>\r\n                <ToolButton\r\n                  onClick={() => {setDrawingMode('EDIT_POINTS')}} active={drawingMode === 'EDIT_POINTS'}>\r\n                  <span role=\"img\" aria-label=\"edit points\">📍 Edit Points</span>\r\n                </ToolButton>\r\n                <ToolButton\r\n                  onClick={() => {setDrawingMode('MOVE_POINTS')}} active={drawingMode === 'MOVE_POINTS'}>\r\n                  <span role=\"img\" aria-label=\"move points\">🕹️ Move Points</span>\r\n                </ToolButton>\r\n              </Fragment>\r\n            )\r\n          }\r\n          </ToolRow>\r\n        </ToolsColumn>\r\n        <ToolsColumn>\r\n          <ColorPalette index={0}></ColorPalette>\r\n          <ColorPalette index={1}></ColorPalette>\r\n        </ToolsColumn>\r\n        <ToolsColumn>\r\n          <PatternToggle></PatternToggle>\r\n        </ToolsColumn>\r\n      </ToolsWrap>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    activeCommand: state.activeCommand,\r\n    drawingMode: state.drawingMode\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, {addCommand, addBackground, setDrawingMode, openModal})(ToolsPalette);\r\n","import * as types from './actionTypes';\r\n\r\nexport function setDrawingMode(mode) {\r\n  return {\r\n    type: types.SET_DRAWING_MODE,\r\n    payload: mode\r\n  };\r\n}","import * as types from './actionTypes';\r\n\r\nexport function openModal() {\r\n  return {\r\n    type: types.OPEN_MODAL\r\n  };\r\n}\r\n\r\nexport function closeModal() {\r\n  return {\r\n    type: types.CLOSE_MODAL\r\n  };\r\n}","import React, { Component } from 'react';\r\nimport { connect } from 'react-redux';\r\nimport styled from 'styled-components';\r\n\r\nimport {closeModal} from '../actions/modal';\r\nimport {setCommands} from '../actions/commands';\r\n\r\nconst Overlay = styled.div`\r\n  position: absolute;\r\n  width: 100%;\r\n  height: 100%;\r\n  background-color: rgba(0,0,0,0.5);\r\n  z-index: 5;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  align-items: center;\r\n`;\r\n\r\nconst ModalWindow = styled.div`\r\n  background-color: #fff;\r\n  box-shadow: 0px 10px 20px rgba(0,0,0,0.1);\r\n  cursor: auto;\r\n`;\r\n\r\nconst Header = styled.div`\r\n  display: flex;\r\n  flex-direction: row;\r\n  justify-content: space-between;\r\n  padding: 10px;\r\n\r\n  p {\r\n    margin: 0 10px 0 0;\r\n  }\r\n`;\r\n\r\nconst Body = styled.div`\r\n  padding: 10px;\r\n`;\r\n\r\nconst ExitButton = styled.div`\r\n  cursor: pointer;\r\n`;\r\n\r\nclass ExportModal extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.exitModal = this.exitModal.bind(this);\r\n    this.importFile = this.importFile.bind(this);\r\n  }\r\n\r\n  importFile(evt) {\r\n    const reader = new FileReader();\r\n    reader.onload = (loadevt) => {\r\n      const data = JSON.parse(loadevt.target.result);\r\n      this.props.setCommands(data);\r\n      this.props.closeModal();\r\n    };\r\n    reader.readAsText(evt.target.files[0]);\r\n  }\r\n\r\n  calculatePattern(values) {\r\n    let count = 0;\r\n    values.forEach((v, id) => {\r\n      let w = 0;\r\n      if (v && id > 0) {\r\n        w = Math.pow(2,15-id);\r\n      }\r\n      else if (v) {\r\n        w -= 32768;\r\n      }\r\n      count += w;\r\n    });\r\n    return count;\r\n  }\r\n\r\n  compressToPico(cmds) {\r\n    let str = 'function()\\n';\r\n    cmds.forEach(cmd => {\r\n      if (cmd.type === 'POLYGON') {\r\n        str += ' poly('\r\n      }\r\n      else if (cmd.type === 'LINE') {\r\n        str += ' pline('\r\n      }\r\n      let hexCol = (16 * cmd.colors[1] + cmd.colors[0]);\r\n      const patternData = this.calculatePattern(cmd.pattern);\r\n      str += `'${cmd.points.join(',')}', 0x${hexCol.toString(16)}, ${patternData})\\n`;\r\n    });\r\n    str += 'end\\n'\r\n    return str;\r\n  }\r\n\r\n  exitModal(evt) {\r\n    evt.stopPropagation();\r\n    this.props.closeModal();\r\n  }\r\n\r\n  render() {\r\n    const {commands, modalOpen} = this.props;\r\n    if (!modalOpen) return null;\r\n\r\n    const jsonBlob = new Blob([JSON.stringify(commands, null, 2)], { type: 'application/json' });\r\n    const picoBlob = new Blob([this.compressToPico(commands)], { type: 'text/plain' });\r\n    const jsonUrl = window.URL.createObjectURL(jsonBlob);\r\n    const picoUrl = window.URL.createObjectURL(picoBlob);\r\n\r\n    return (\r\n      <Overlay>\r\n        <ModalWindow>\r\n          <Header>\r\n            <p>\r\n              Import and export data\r\n            </p>\r\n            <ExitButton onClick={this.exitModal}><span role=\"img\" aria-label=\"exit modal button\">❌</span></ExitButton>\r\n          </Header>\r\n          <Body>\r\n            <p>\r\n              Import JSON: <input type=\"file\" onChange={this.importFile} /> \r\n            </p>\r\n            <p>\r\n              <a download=\"gmagic_drawing.json\" href={jsonUrl}>Download JSON</a>\r\n            </p>\r\n            <p>\r\n              <a download=\"gmagic_drawing.txt\" href={picoUrl}>Download PICO-8 code</a>\r\n            </p>\r\n          </Body>\r\n        </ModalWindow>\r\n      </Overlay>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    commands: state.commands,\r\n    modalOpen: state.modalOpen\r\n  };\r\n}\r\n\r\nexport default connect(mapStateToProps, {closeModal, setCommands})(ExportModal);\r\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport styled from 'styled-components';\n\nimport Canvas from './Canvas';\nimport CommandList from './CommandList';\nimport ToolsPalette from './ToolsPalette';\nimport ExportModal from './ExportModal';\n\nconst Row = styled.div`\n  width: 100%;\n  height: 80vh;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: flex-start;\n  margin: 0;\n`;\n\nconst Wrap = styled.div`\n  position: absolute;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  top: 0;\n  display: flex;\n  flex-direction: column;\n`;\n\nclass App extends Component {\n  render() {\n    return (\n      <Wrap>\n        <Row>\n          <Canvas></Canvas>\n          <CommandList></CommandList>\n        </Row>\n        <ToolsPalette></ToolsPalette>\n        <ExportModal />\n      </Wrap>\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {};\n}\n\nexport default connect(mapStateToProps)(App);\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","export default {\r\n  commands: [\r\n    {\r\n      id: 12345,\r\n      name: 'Background',\r\n      type: 'POLYGON',\r\n      points: [\r\n        0, 0, 127, 0, 127, 127, 0, 127\r\n      ],\r\n      colors: [6,7],\r\n      pattern: [\r\n        true, true, false, false,\r\n        true, true, false, false,\r\n        false, false, true, true,\r\n        false, false, true, true\r\n      ]\r\n    }\r\n  ],\r\n  activeCommand: null,\r\n  drawingMode: 'EDIT_POINTS',\r\n  modalOpen: false\r\n}","import { combineReducers } from 'redux';\r\n\r\nimport commandsReducer from './commands';\r\nimport activeCommandReducer from './activeCommand';\r\nimport drawingModeReducer from './drawingMode'\r\nimport modalReducer from './modal';\r\n\r\nexport default combineReducers({\r\n  commands: commandsReducer,\r\n  activeCommand: activeCommandReducer,\r\n  drawingMode: drawingModeReducer,\r\n  modalOpen: modalReducer\r\n});\r\n","import initialState from '../store/initialState';\r\nimport * as types from '../actions/actionTypes';\r\n\r\nexport default function commandsReducer(state = initialState.commands, action) {\r\n  switch (action.type) {\r\n    \r\n    case types.ADD_COMMAND:\r\n      return [\r\n        ...state,\r\n        {\r\n          id: action.payload.id,\r\n          name: `cmd-${action.payload.id}`,\r\n          type: action.payload.type,\r\n          points: [],\r\n          colors: [0,7],\r\n          pattern: [\r\n            false, false, false, false,\r\n            false, false, false, false,\r\n            false, false, false, false,\r\n            false, false, false, false\r\n          ]\r\n        }\r\n      ];\r\n    \r\n    case types.REMOVE_COMMAND:\r\n      return [\r\n        ...state.filter(comm => comm.id !== action.payload.id)\r\n      ];\r\n\r\n      case types.ADD_BACKGROUND:\r\n      return [\r\n        {\r\n          id: action.payload.id,\r\n          name: `Background-${action.payload.id}`,\r\n          type: action.payload.type,\r\n          points: [0,0, 127,0, 127,127, 0,127],\r\n          colors: [7,0],\r\n          pattern: [\r\n            false, false, false, false,\r\n            false, false, false, false,\r\n            false, false, false, false,\r\n            false, false, false, false\r\n          ]\r\n        },\r\n        ...state\r\n      ];\r\n\r\n    case types.MOVE_COMMAND_UP: {\r\n      let foundCmdIndex = state.findIndex(cmd => cmd.id === action.payload.id);\r\n      if (foundCmdIndex <= 0) {\r\n        // if 0 nowhere to move up\r\n        return [...state];\r\n      }\r\n      let foundCmd = state[foundCmdIndex];\r\n      return [\r\n        ...state.slice(0, foundCmdIndex-1),\r\n        { ...foundCmd },\r\n        {...state[foundCmdIndex-1]},\r\n        ...state.slice(foundCmdIndex+1)\r\n      ];\r\n    }\r\n\r\n    case types.MOVE_COMMAND_DOWN: {\r\n      let foundCmdIndex = state.findIndex(cmd => cmd.id === action.payload.id);\r\n      if (foundCmdIndex <0 || foundCmdIndex === state.length-1) {\r\n        // if not found or furthest down ignore\r\n        return [...state];\r\n      }\r\n      let foundCmd = state[foundCmdIndex];\r\n      return [\r\n        ...state.slice(0, foundCmdIndex),\r\n        {...state[foundCmdIndex+1]},\r\n        { ...foundCmd },\r\n        ...state.slice(foundCmdIndex+2)\r\n      ];\r\n    }\r\n\r\n    case types.MOVE_POINT: {\r\n      const {id, index, x, y} = action.payload;\r\n      return state.map(cmd => {\r\n        if (cmd.id === id) {\r\n          return {\r\n            ...cmd,\r\n            points: cmd.points.map((pt, idx) => {\r\n              if (idx === index) {\r\n                return x;\r\n              }\r\n              else if(idx === index+1) {\r\n                return y;\r\n              }\r\n              return pt;\r\n            })\r\n          }\r\n        }\r\n        return cmd;\r\n      })\r\n    }\r\n\r\n    case types.ADD_POINT: {\r\n      const {id, x, y} = action.payload;\r\n      return state.map(cmd => {\r\n        if (cmd.id === id) {\r\n          return {\r\n            ...cmd,\r\n            points: [\r\n              ...cmd.points,\r\n              x,\r\n              y\r\n            ]\r\n          }\r\n        }\r\n        return cmd;\r\n      });\r\n    }\r\n\r\n    case types.REMOVE_POINT: {\r\n      const {id, index} = action.payload;\r\n      return state.map(cmd => {\r\n        if (cmd.id === id) {\r\n          return {\r\n            ...cmd,\r\n            points: cmd.points.splice(index, 2)\r\n          }\r\n        }\r\n        return cmd;\r\n      });\r\n    }\r\n\r\n    case types.SET_COLOR: {\r\n      const {id, color, index} = action.payload;\r\n      return state.map(cmd => {\r\n        if (cmd.id === id) {\r\n          return {\r\n            ...cmd,\r\n            colors: cmd.colors.map((someCol, someIndex) => {\r\n              if (index === someIndex) {\r\n                return color;\r\n              }\r\n              return someCol;\r\n            })\r\n          }\r\n        }\r\n        return cmd;\r\n      });\r\n    }\r\n\r\n    case types.NAME_COMMAND: {\r\n      const {id, name} = action.payload;\r\n      return state.map(cmd => {\r\n        if (cmd.id === id) {\r\n          return {\r\n            ...cmd,\r\n            name\r\n          }\r\n        }\r\n        return cmd;\r\n      });\r\n    }\r\n\r\n    case types.SET_PATTERN: {\r\n      const {id, pattern} = action.payload;\r\n      return state.map(cmd => {\r\n        if (cmd.id === id) {\r\n          return {\r\n            ...cmd,\r\n            pattern: [...pattern]\r\n          }\r\n        }\r\n        return cmd;\r\n      });\r\n    }\r\n\r\n    case types.SET_COMMANDS: {\r\n      // TODO: some command validation\r\n      return [\r\n        ...action.payload\r\n      ];\r\n    }\r\n\r\n    case types.MOVE_COMMAND: {\r\n      const {id, x, y} = action.payload;\r\n      return state.map(cmd => {\r\n        if (cmd.id === id) {\r\n          return {\r\n            ...cmd,\r\n            points: cmd.points.map((pt, index) => {\r\n              if (index % 2 === 0) {\r\n                // x\r\n                return pt + x;\r\n              }\r\n              else {\r\n                // y\r\n                return pt + y;\r\n              }\r\n            })\r\n          }\r\n        }\r\n        return cmd;\r\n      });\r\n    }\r\n    \r\n    default:\r\n      return state;\r\n  }\r\n}","import initialState from '../store/initialState';\r\nimport * as types from '../actions/actionTypes';\r\n\r\nexport default function activeCommandReducer(state = initialState.activeCommand, action) {\r\n  switch (action.type) {\r\n    \r\n    case types.SET_ACTIVE_COMMAND:\r\n      return action.payload;\r\n    \r\n    // when addCommand is called, set that command to active\r\n    case types.ADD_COMMAND:\r\n      return action.payload.id;\r\n    \r\n    case types.REMOVE_COMMAND: {\r\n      return (action.payload.id === state) ? null : state;\r\n    }\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}","import initialState from '../store/initialState';\r\nimport * as types from '../actions/actionTypes';\r\n\r\nexport default function drawingModeReducer(state = initialState.drawingMode, action) {\r\n  switch (action.type) {\r\n    \r\n    case types.SET_DRAWING_MODE:\r\n      return action.payload;\r\n\r\n    case types.SET_ACTIVE_COMMAND:\r\n      return 'EDIT_POINTS';\r\n    \r\n    case types.ADD_COMMAND:\r\n      return 'ADD_POINTS';\r\n    \r\n    default:\r\n      return state;\r\n  }\r\n}","import initialState from '../store/initialState';\r\nimport * as types from '../actions/actionTypes';\r\n\r\nexport default function modalReducer(state = initialState.modalOpen, action) {\r\n  switch (action.type) {\r\n    \r\n    case types.OPEN_MODAL:\r\n      return true;\r\n\r\n    case types.CLOSE_MODAL:\r\n      return false;\r\n\r\n    default:\r\n      return state;\r\n  }\r\n}","import { createStore } from 'redux';\r\nimport rootReducer from '../reducers/index';\r\nimport initialState from './initialState';\r\n\r\nexport default createStore(\r\n  rootReducer,\r\n  initialState,\r\n  window.__REDUX_DEVTOOLS_EXTENSION__ && window.__REDUX_DEVTOOLS_EXTENSION__()\r\n);","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\nimport * as serviceWorker from './serviceWorker';\nimport { Provider } from 'react-redux';\nimport store from './store';\n\nconst rootElement = document.getElementById('root');\n\nReactDOM.render((\n  <Provider store={store}>\n    <App />\n  </Provider>\n  ), rootElement);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}